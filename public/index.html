<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.8.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zehai.info","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="ä¼šåšé¥­çš„å¨å­">
<meta property="og:type" content="website">
<meta property="og:title" content="Zehai&#39;blog">
<meta property="og:url" content="http://zehai.info/index.html">
<meta property="og:site_name" content="Zehai&#39;blog">
<meta property="og:description" content="ä¼šåšé¥­çš„å¨å­">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Zehai&#39;blog">
<meta name="twitter:description" content="ä¼šåšé¥­çš„å¨å­">

<link rel="canonical" href="http://zehai.info/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false
  };
</script>

  <title>Zehai'blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Zehai'blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives<span class="badge">94</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories<span class="badge">29</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags<span class="badge">28</span></a>

  </li>
        <li class="menu-item menu-item-mysql">

    <a href="/MySQL/" rel="section"><i class="fa fa-fw fa-database"></i>MySQL</a>

  </li>
        <li class="menu-item menu-item-redis">

    <a href="/Redis/" rel="section"><i class="fa fa-fw fa-rebel"></i>Redis</a>

  </li>
        <li class="menu-item menu-item-cnetwork">

    <a href="/cnetwork" rel="section"><i class="fa fa-fw fa-desktop"></i>CNetwork</a>

  </li>
        <li class="menu-item menu-item-structure">

    <a href="/Structure" rel="section"><i class="fa fa-fw fa-asterisk"></i>Structure</a>

  </li>
        <li class="menu-item menu-item-nodejs">

    <a href="/Nodejs" rel="section"><i class="fa fa-fw fa-code"></i>NodeJS</a>

  </li>
        <li class="menu-item menu-item-interview">

    <a href="/Interview" rel="section"><i class="fa fa-fw fa-commenting"></i>Interview</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-readme">

    <a href="/README/" rel="section"><i class="fa fa-fw fa-info"></i>README</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zehai.info/2020/05/29/2020-05-29-deno/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
      <meta itemprop="name" content="Zhang Zehai">
      <meta itemprop="description" content="ä¼šåšé¥­çš„å¨å­">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zehai'blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/29/2020-05-29-deno/" class="post-title-link" itemprop="url">deno</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-05-29 16:18:55" itemprop="dateCreated datePublished" datetime="2020-05-29T16:18:55+08:00">2020-05-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 09:40:04" itemprop="dateModified" datetime="2020-05-30T09:40:04+08:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/nodejs/" itemprop="url" rel="index"><span itemprop="name">nodejs</span></a>
                </span>
            </span>

          
            <span id="/2020/05/29/2020-05-29-deno/" class="post-meta-item leancloud_visitors" data-flag-title="deno" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/05/29/2020-05-29-deno/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/05/29/2020-05-29-deno/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="0-Attention"><a href="#0-Attention" class="headerlink" title="0. Attention"></a>0. Attention</h1><p>æœ¬æ–‡ä¸ºä¸ªäººç¿»è¯‘ï¼Œå­¦ä¹ è¾“å‡ºï¼Œä»…ä¾›å‚è€ƒï¼Œæ¬¢è¿æŒ‡å‡ºç†è§£ä¸è¶³ä¹‹å¤„</p>
<h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><h1 id="2-Getting-Started"><a href="#2-Getting-Started" class="headerlink" title="2.Getting Started"></a>2.Getting Started</h1><h2 id="2-1-Installation"><a href="#2-1-Installation" class="headerlink" title="2.1 Installation"></a>2.1 Installation</h2><h2 id="2-2-Setup-your-environment"><a href="#2-2-Setup-your-environment" class="headerlink" title="2.2 Setup your environment"></a>2.2 Setup your environment</h2><h2 id="2-3-First-steps"><a href="#2-3-First-steps" class="headerlink" title="2.3 First steps"></a>2.3 First steps</h2><h3 id="2-3-1-helloworld"><a href="#2-3-1-helloworld" class="headerlink" title="2.3.1 helloworld"></a>2.3.1 helloworld</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"Welcome to Deno ğŸ¦•"</span>);</span><br><span class="line">deno run https:<span class="comment">//deno.land/std/examples/welcome.ts</span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-2-Make-http-request"><a href="#2-3-2-Make-http-request" class="headerlink" title="2.3.2 Make http request"></a>2.3.2 Make http request</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> url = Deno.args[<span class="number">0</span>];<span class="comment">//get url</span></span><br><span class="line"><span class="keyword">const</span> res = <span class="keyword">await</span> fetch(url);<span class="comment">//await response --&gt;res</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> body = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(<span class="keyword">await</span> res.arrayBuffer());<span class="comment">//parse body as ArrayBuffer and convert into Uint8Array</span></span><br><span class="line"><span class="keyword">await</span> Deno.stdout.write(body);<span class="comment">//write body --&gt; stdout</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//run</span></span><br><span class="line"><span class="comment">//wrong cause no permision</span></span><br><span class="line">deno run https:<span class="comment">//deno.land/std/examples/curl.ts https://example.com</span></span><br><span class="line"><span class="comment">//right</span></span><br><span class="line">deno run --allow-net=example.com https:<span class="comment">//deno.land/std/examples/curl.ts https://example.com</span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-3-reading-a-file"><a href="#2-3-3-reading-a-file" class="headerlink" title="2.3.3 reading a file"></a>2.3.3 reading a file</h3><p>denoæä¾›éæºè‡ªç½‘ç»œçš„apiï¼Œè¿™äº›å¯ä»¥åœ¨denoå…¨å±€è°ƒç”¨ï¼Œç”±äºç›®å‰æ²¡æœ‰webæ ‡å‡†ï¼Œæ‰€ä»¥denoå°±è‡ªå·±åšäº†ä¸€å¥—æ ‡å‡†ï¼Œä»¥ä¸‹ç¤ºä¾‹filenameâ€“&gt;openâ€“&gt;print</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filenames = Deno.args;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> filename <span class="keyword">of</span> filenames) &#123;</span><br><span class="line">  <span class="keyword">const</span> file = <span class="keyword">await</span> Deno.open(filename);</span><br><span class="line">  <span class="keyword">await</span> Deno.copy(file, Deno.stdout);</span><br><span class="line">  file.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨äº†<strong>kernel-&gt;user-&gt;kernel</strong>çš„æ–¹å¼copyï¼Œä¿è¯æ•°æ®<strong>ä¸€è‡´æ€§</strong></p>
<p>é¿å…äº†å¸¸è§çš„4æ¬¡æ‹·è´</p>
<ol>
<li>ç£ç›˜â€”â€“DMAâ€”-&gt;é¡µç¼“å­˜ï¼ˆkernelï¼‰</li>
<li>é¡µç¼“å­˜(kernel)â€“&gt;ç”¨æˆ·ç¼“å­˜ï¼ˆuserï¼‰</li>
<li>ç”¨æˆ·ç¼“å­˜ï¼ˆuserï¼‰â€“&gt;socketç¼“å†²åŒºï¼ˆkernelï¼‰</li>
<li>Socket(kernel)â€”DMA copyâ€”&gt;network</li>
</ol>
<p>ç»è¿‡å¤šæ¬¡æ‹·è´ï¼Œç¼“å­˜æ•°æ®å¯èƒ½è¢«ä¿®æ”¹ï¼Œ<strong>å¯¼è‡´å’ŒåŸæ–‡ä»¶æ•°æ®ä¸ä¸€è‡´</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deno run --allow-read https://deno.land/std/examples/cat.ts /etc/passwd</span><br></pre></td></tr></table></figure>
<h3 id="2-3-4-tcp-server"><a href="#2-3-4-tcp-server" class="headerlink" title="2.3.4 tcp server"></a>2.3.4 tcp server</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> hostname = <span class="string">"0.0.0.0"</span>;</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8080</span>;</span><br><span class="line"><span class="keyword">const</span> listener = Deno.listen(&#123; hostname, port &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`Listening on <span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> conn <span class="keyword">of</span> listener) &#123;</span><br><span class="line">  Deno.copy(conn, conn);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœªç»å…è®¸ä¸å¯è®¿é—®ç½‘ç»œï¼Œå¦‚æœéœ€è¦ï¼Œåˆ™æ·»åŠ â€“allow-net</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deno run --allow-net https://deno.land/std/examples/echo_server.ts</span><br><span class="line">//shell netcat(nc)</span><br><span class="line">nc localhost 8080</span><br><span class="line">hello world//input</span><br></pre></td></tr></table></figure>
<h2 id="2-4-Permissions"><a href="#2-4-Permissions" class="headerlink" title="2.4 Permissions"></a>2.4 Permissions</h2><p>denoæ‹¥æœ‰ä¸¥æ ¼çš„æƒé™ç®¡ç†ï¼Œé™¤éä½ å£°æ˜ï¼Œå¦åˆ™denoä¸ä¼šæœ‰file network enviromentæƒé™ï¼Œèµ‹äºˆåªè¯»æƒé™å°±ä¸ä¼šæœ‰è¯»å†™æƒé™</p>
<h3 id="2-4-1-Permissions-list"><a href="#2-4-1-Permissions-list" class="headerlink" title="2.4.1 Permissions list"></a>2.4.1 Permissions list</h3><ul>
<li><strong>-A, â€“allow-all</strong> Allow all permissions. This disables all security.</li>
<li><strong>â€“allow-env</strong> Allow environment access for things like getting and setting of environment variables.</li>
<li><strong>â€“allow-hrtime</strong> Allow high resolution time measurement. High resolution time can be used in timing attacks and fingerprinting.</li>
<li><strong>â€“allow-net=\<allow-net></allow-net></strong> Allow network access. You can specify an optional, comma separated list of domains to provide a whitelist of allowed domains.</li>
<li><strong>â€“allow-plugin</strong> Allow loading plugins. Please note that â€“allow-plugin is an unstable feature.</li>
<li><strong>â€“allow-read=\<allow-read></allow-read></strong> Allow file system read access. You can specify an optional, comma separated list of directories or files to provide a whitelist of allowed file system access.</li>
<li><strong>â€“allow-run</strong> Allow running subprocesses. Be aware that subprocesses are not run in a sandbox and therefore do not have the same security restrictions as the deno process. Therefore, use with caution.</li>
<li><strong>â€“allow-write=\<allow-write></allow-write></strong> Allow file system write access. You can specify an optional, comma separated list of directories or files to provide a whitelist of allowed file system access.</li>
</ul>
<h3 id="2-4-2-Permission-whitelist"><a href="#2-4-2-Permission-whitelist" class="headerlink" title="2.4.2 Permission whitelist"></a>2.4.2 Permission whitelist</h3><p>é€šè¿‡ç™½åå•ï¼Œå®ç°æ›´é«˜ç²’åº¦çš„æƒé™æ§åˆ¶</p>
<p>ç¤ºä¾‹ç»™äºˆ/usræƒé™ï¼Œä½†è®¿é—®/etc</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> deno run --allow-read=/usr https://deno.land/std/examples/cat.ts /etc/passwd</span><br><span class="line">error: Uncaught PermissionDenied: read access to "/etc/passwd", run again with the --allow-read flag</span><br><span class="line">â–º $deno$/dispatch_json.ts:40:11</span><br><span class="line">    at DenoError ($deno$/errors.ts:20:5)</span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">//yes    </span><br><span class="line"><span class="meta">$</span> deno run --allow-read=/etc https://deno.land/std/examples/cat.ts /etc/passwd</span><br></pre></td></tr></table></figure>
<h3 id="2-4-3-Network-access"><a href="#2-4-3-Network-access" class="headerlink" title="2.4.3 Network access"></a>2.4.3 Network access</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> result = <span class="keyword">await</span> fetch(<span class="string">"https://deno.land/"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//run</span></span><br><span class="line">$ deno run --allow-net=github.com,deno.land fetch.ts<span class="comment">//failed</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<p>å¦‚æœfetch.tså°è¯•ä¸åˆ«çš„domainå»ºç«‹è¿æ¥ï¼Œprocesså°†ä¼šå¤±è´¥ï¼Œä½¿ç”¨<code>deno run --allow-net fetch.ts</code>åˆ™å¯ä»¥</p>
<h2 id="2-5-Using-TS"><a href="#2-5-Using-TS" class="headerlink" title="2.5 Using TS"></a>2.5 Using TS</h2><p>å¤©ç”Ÿæ”¯æŒJS,TSï¼Œéœ€è¦å¼•å…¥æ¨¡å—æ‹“å±•ï¼Œä½¿ç”¨æ–‡ä»¶ï¼Œæˆ–è€…urlè¿›è¡Œå¯¼å…¥</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Response &#125; <span class="keyword">from</span> <span class="string">"https://deno.land/std@0.53.0/http/server.ts"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; queue &#125; <span class="keyword">from</span> <span class="string">"./collections.ts"</span>;</span><br></pre></td></tr></table></figure>
<h3 id="2-5-1-Using-external-type-definitions"><a href="#2-5-1-Using-external-type-definitions" class="headerlink" title="2.5.1 Using external type definitions"></a>2.5.1 Using external type definitions</h3><p>å¼€ç®±å³ç”¨çš„TSç¼–è¯‘å™¨ï¼Œä¹Ÿä¾é æ— æ‰©å±•æ¨¡å—(extension-less modules)ï¼Œnodeæ¨¡å—è§£æé€»è¾‘(module resolution logic)æ¥å®ç°å°†ç±»å‹ï¼ˆtpyesï¼‰åº”ç”¨äºJSæ¨¡å—ï¼Œä¸ºäº†ç»™TSä¸JSå»ºç«‹æ¡¥æ¢ï¼Œæ”¯æŒä¸‰ç§å¼•ç”¨ç±»å‹å®šä¹‰æ–‡ä»¶çš„æ–¹å¼</p>
<ul>
<li><p>compiler hint</p>
</li>
<li><p>Triple-slash reference directive</p>
</li>
<li><h4 id="X-TypeScript-Types-custom-header"><a href="#X-TypeScript-Types-custom-header" class="headerlink" title="X-TypeScript-Types custom header"></a>X-TypeScript-Types custom header</h4></li>
</ul>
<p>Compiler hint ï¼šå½“ä½ çŸ¥é“æ–‡ä»¶ä½ç½®æ—¶å€™å¼•ç”¨,denoç¼–è¯‘å™¨ä¼šå¤¹åœ¨foo.d.tsè€Œä¸æ˜¯foo.js</p>
<p>å½“è¿è¡Œæ—¶ï¼ŒDenoä¼šä¸€ç›´åŠ è½½foo.js</p>
<p><a href="https://deno.land/manual/getting_started/typescript#compiler-hint" target="_blank" rel="noopener">ä¸å…¨å¾…è¡¥å……</a></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @deno-types="./foo.d.ts"</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> foo <span class="keyword">from</span> <span class="string">"./foo.js"</span>;</span><br></pre></td></tr></table></figure>
<p>ä¸æ˜¯æ‰€æœ‰å®šä¹‰éƒ½æ”¯æŒï¼šdenoä¼šåŠ è½½*.d.tsæ–‡ä»¶ï¼Œä½†ä¸æ˜¯æ‰€æœ‰æ–‡ä»¶éƒ½æ”¯æŒï¼Œå¦‚è®¿é—®:<code>./node_modules/@types/node/index.d.ts</code></p>
<p>ä¸ºä»€ä¹ˆTSæ–‡ä»¶ä¸­ä¸ä½¿ç”¨triple-slash type reference</p>
<p>å¦‚æœä½¿ç”¨ï¼Œå¹²æ‰°TSç¼–è¯‘å™¨çš„è¡Œä¸ºï¼ŒDenoå°½åœ¨JSå’ŒJSXæ–‡ä»¶ä¸­æŸ¥æ‰¾æŒ‡ä»¤</p>
<h3 id="2-5-2-Custom-TypeScript-Compiler-Options"><a href="#2-5-2-Custom-TypeScript-Compiler-Options" class="headerlink" title="2.5.2 Custom TypeScript Compiler Options"></a>2.5.2 Custom TypeScript Compiler Options</h3><p>Deno é»˜è®¤å¼€å§‹ä¸¥æ ¼æ¨¡å¼ï¼Œä½¿ç”¨<code>tsconfig.ts</code>æ¥é…ç½®ï¼Œéœ€è¦é€šè¿‡-cæ¥å‘Šè¯‰denoé…ç½®æ–‡ä»¶<code>deno run -c tsconfig.json mod.ts</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">//default optins</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"allowJs"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"allowUmdGlobalAccess"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"allowUnreachableCode"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"allowUnusedLabels"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"alwaysStrict"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"assumeChangesOnlyAffectDirectDependencies"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"checkJs"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"disableSizeLimit"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"generateCpuProfile"</span>: <span class="string">"profile.cpuprofile"</span>,</span><br><span class="line">    <span class="attr">"jsx"</span>: <span class="string">"react"</span>,</span><br><span class="line">    <span class="attr">"jsxFactory"</span>: <span class="string">"React.createElement"</span>,</span><br><span class="line">    <span class="attr">"lib"</span>: [],</span><br><span class="line">    <span class="attr">"noFallthroughCasesInSwitch"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"noImplicitAny"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"noImplicitReturns"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"noImplicitThis"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"noImplicitUseStrict"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"noStrictGenericChecks"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"noUnusedLocals"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"noUnusedParameters"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"preserveConstEnums"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"removeComments"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"resolveJsonModule"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"strict"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"strictBindCallApply"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"strictFunctionTypes"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"strictNullChecks"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"strictPropertyInitialization"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"suppressExcessPropertyErrors"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"suppressImplicitAnyIndexErrors"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"useDefineForClassFields"</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-6-Using-WebAssembly"><a href="#2-6-Using-WebAssembly" class="headerlink" title="2.6 Using WebAssembly"></a>2.6 Using WebAssembly</h2><p>denoå¯ä»¥æ‰§è¡Œ<code>wasm</code>äºŒè¿›åˆ¶æ–‡ä»¶</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> wasmCode = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>([</span><br><span class="line">  <span class="number">0</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">133</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">96</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">127</span>,</span><br><span class="line">  <span class="number">3</span>, <span class="number">130</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">  <span class="number">5</span>, <span class="number">131</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">129</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">145</span>,</span><br><span class="line">  <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">109</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">109</span>, <span class="number">97</span>,</span><br><span class="line">  <span class="number">105</span>, <span class="number">110</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">138</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">132</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">  <span class="number">65</span>, <span class="number">42</span>, <span class="number">11</span></span><br><span class="line">]);</span><br><span class="line"><span class="keyword">const</span> wasmModule = <span class="keyword">new</span> WebAssembly.Module(wasmCode);</span><br><span class="line"><span class="keyword">const</span> wasmInstance = <span class="keyword">new</span> WebAssembly.Instance(wasmModule);</span><br><span class="line"><span class="built_in">console</span>.log(wasmInstance.exports.main().toString());</span><br></pre></td></tr></table></figure>
<h1 id="3-The-Runtime"><a href="#3-The-Runtime" class="headerlink" title="3. The Runtime"></a>3. The Runtime</h1><p>Runtime functions(web Apis + deco global)</p>
<h2 id="3-1-Stability"><a href="#3-1-Stability" class="headerlink" title="3.1 Stability"></a>3.1 Stability</h2><p>è‡ª1.0.0ç‰ˆæœ¬åï¼Œå„APIè¶‹äºç¨³å®šï¼Œä½†å¹¶éæ‰€æœ‰çš„APIéƒ½å¯ä»¥æŠ•å…¥prodä½¿ç”¨ï¼Œä½¿ç”¨â€“unstableè§£é™¤é”å®š</p>
<h2 id="3-2-Program-lifecycle"><a href="#3-2-Program-lifecycle" class="headerlink" title="3.2 Program lifecycle"></a>3.2 Program lifecycle</h2><p>denoæ”¯æŒä¸æµè§ˆå™¨å…¼å®¹çš„ç”Ÿå‘½å‘¨æœŸeventsï¼Œ<code>load</code> and <code>unload</code></p>
<p>ä½ å¯ä»¥ä½¿ç”¨è¿™äº›eventsï¼Œåœ¨ä½ çš„ç¨‹åºä¸­æä¾› setup/cleanup code</p>
<p>load æ˜¯å¼‚æ­¥çš„ï¼Œç­‰å¾…çš„ï¼Œ<strong>ä¸å¯å–æ¶ˆçš„</strong></p>
<p>unloadæ˜¯åŒæ­¥çš„ï¼Œ<strong>ä¸å¯å–æ¶ˆçš„</strong></p>
<p><strong>main.ts</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"./imported.ts"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handler = (e: Event): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`got <span class="subst">$&#123;e.type&#125;</span> event in event handler (main)`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"load"</span>, handler);</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"unload"</span>, handler);</span><br><span class="line"><span class="built_in">window</span>.onload = (e: Event): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`got <span class="subst">$&#123;e.type&#125;</span> event in onload function (main)`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.onunload = (e: Event): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`got <span class="subst">$&#123;e.type&#125;</span> event in onunload function (main)`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"log from main script"</span>);</span><br></pre></td></tr></table></figure>
<p><strong>imported.ts</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> handler = (e: Event): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`got <span class="subst">$&#123;e.type&#125;</span> event in event handler (imported)`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"load"</span>, handler);</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"unload"</span>, handler);</span><br><span class="line"><span class="built_in">window</span>.onload = (e: Event): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`got <span class="subst">$&#123;e.type&#125;</span> event in onload function (imported)`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.onunload = (e: Event): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`got <span class="subst">$&#123;e.type&#125;</span> event in onunload function (imported)`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"log from imported script"</span>);</span><br></pre></td></tr></table></figure>
<p>run</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> deno run main.ts</span><br><span class="line">log from imported script</span><br><span class="line">log from main script</span><br><span class="line">got load event in onload function (main)</span><br><span class="line">got load event in event handler (imported)</span><br><span class="line">got load event in event handler (main)</span><br><span class="line">got unload event in onunload function (main)</span><br><span class="line">got unload event in event handler (imported)</span><br><span class="line">got unload event in event handler (main)</span><br></pre></td></tr></table></figure>
<p>Importes.tsçš„æ–¹æ³•è¢«mainè¦†ç›–</p>
<h2 id="3-3-Compiler-APIs"><a href="#3-3-Compiler-APIs" class="headerlink" title="3.3 Compiler APIs"></a>3.3 Compiler APIs</h2><p>ç›®å‰ç¼–è¯‘å™¨çš„apisæ˜¯unstableçš„ï¼Œdenoæ”¯æŒå¯¹å†…ç½®tsç¼–è¯‘å™¨runtimeçš„è®¿é—®ï¼Œæœ‰ä¸‰ç§æ–¹æ³•è®¿é—®</p>
<ul>
<li>Deno.complie()</li>
<li>Deno.bundle()</li>
<li>Deno.transpileOnly()</li>
</ul>
<h3 id="3-3-1-Referencing-TypeScipt-library-files"><a href="#3-3-1-Referencing-TypeScipt-library-files" class="headerlink" title="3.3.1 Referencing TypeScipt library files"></a>3.3.1 Referencing TypeScipt library files</h3><h2 id="3-4-Workers"><a href="#3-4-Workers" class="headerlink" title="3.4 Workers"></a>3.4 Workers</h2><p>denoæ”¯æŒweb worker api</p>
<p>workerå¯ä»¥åœ¨å¤šçº¿ç¨‹ä¸Šè¿è¡Œä»£ç ï¼Œæ¯ä¸ªworkerå®ä¾‹åœ¨å•ç‹¬ä¸“ç”¨çš„çº¿ç¨‹ä¸Šè¿è¡Œï¼Œç›®å‰ä»…æ”¯æŒ<code>module</code>ç±»å‹çš„worker</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Good</span></span><br><span class="line"><span class="keyword">new</span> Worker(<span class="string">"./worker.js"</span>, &#123; <span class="keyword">type</span>: <span class="string">"module"</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Bad</span></span><br><span class="line"><span class="keyword">new</span> Worker(<span class="string">"./worker.js"</span>);</span><br><span class="line"><span class="keyword">new</span> Worker(<span class="string">"./worker.js"</span>, &#123; <span class="keyword">type</span>: <span class="string">"classic"</span> &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="3-4-1-Permissions"><a href="#3-4-1-Permissions" class="headerlink" title="3.4.1 Permissions"></a>3.4.1 Permissions</h3><p>åˆ›å»ºæ–°çš„workeræ˜¯åŠ¨æ€å¯¼å…¥ï¼Œéœ€è¦èµ‹äºˆæƒé™</p>
<p><strong>main.ts</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Worker(<span class="string">"./worker.ts"</span>, &#123; <span class="keyword">type</span>: <span class="string">"module"</span> &#125;);</span><br></pre></td></tr></table></figure>
<p><strong>worker.ts</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"hello world"</span>);</span><br><span class="line">self.close();</span><br><span class="line">---</span><br><span class="line">$ deno run main.ts</span><br><span class="line">error: Uncaught PermissionDenied: read access to <span class="string">"./worker.ts"</span>, run again <span class="keyword">with</span> the --allow-read flag</span><br><span class="line">$ deno run --allow-read main.ts</span><br><span class="line">hello world</span><br></pre></td></tr></table></figure>
<p>For workers using remote modules; <code>--allow-net</code> permission is required:</p>
<h3 id="3-4-2-Using-Deno-in-worker"><a href="#3-4-2-Using-Deno-in-worker" class="headerlink" title="3.4.2 Using Deno in worker"></a>3.4.2 Using Deno in worker</h3><p><strong>main.js</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> Worker(<span class="string">"./worker.js"</span>, &#123; <span class="keyword">type</span>: <span class="string">"module"</span>, deno: <span class="literal">true</span> &#125;);</span><br><span class="line">worker.postMessage(&#123; filename: <span class="string">"./log.txt"</span> &#125;);</span><br></pre></td></tr></table></figure>
<p><strong>worker.js</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">self.onmessage = <span class="keyword">async</span> (e) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; filename &#125; = e.data;</span><br><span class="line">  <span class="keyword">const</span> text = <span class="keyword">await</span> Deno.readTextFile(filename);</span><br><span class="line">  <span class="built_in">console</span>.log(text);</span><br><span class="line">  self.close();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>log.txt</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hello world</span><br><span class="line">$ deno run --allow-read --unstable main.js</span><br><span class="line">hello world</span><br></pre></td></tr></table></figure>
<h1 id="4-Linking-to-external-code"><a href="#4-Linking-to-external-code" class="headerlink" title="4. Linking to external code"></a>4. Linking to external code</h1><h1 id="5-Standard-library"><a href="#5-Standard-library" class="headerlink" title="5. Standard library"></a>5. Standard library</h1><h1 id="6-Testing"><a href="#6-Testing" class="headerlink" title="6. Testing"></a>6. Testing</h1><h1 id="7-Tools"><a href="#7-Tools" class="headerlink" title="7. Tools"></a>7. Tools</h1><h1 id="8-Embedding-Deno"><a href="#8-Embedding-Deno" class="headerlink" title="8. Embedding Deno"></a>8. Embedding Deno</h1><h1 id="9-Contributing"><a href="#9-Contributing" class="headerlink" title="9. Contributing"></a>9. Contributing</h1><h1 id="10-Examples"><a href="#10-Examples" class="headerlink" title="10. Examples"></a>10. Examples</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zehai.info/2020/05/13/2020-05-13-ç›‘æ§è½¯ä»¶/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
      <meta itemprop="name" content="Zhang Zehai">
      <meta itemprop="description" content="ä¼šåšé¥­çš„å¨å­">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zehai'blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/13/2020-05-13-ç›‘æ§è½¯ä»¶/" class="post-title-link" itemprop="url">monit</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-05-13 16:18:55" itemprop="dateCreated datePublished" datetime="2020-05-13T16:18:55+08:00">2020-05-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 09:39:47" itemprop="dateModified" datetime="2020-05-30T09:39:47+08:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/monit/" itemprop="url" rel="index"><span itemprop="name">monit</span></a>
                </span>
            </span>

          
            <span id="/2020/05/13/2020-05-13-ç›‘æ§è½¯ä»¶/" class="post-meta-item leancloud_visitors" data-flag-title="monit" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/05/13/2020-05-13-ç›‘æ§è½¯ä»¶/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/05/13/2020-05-13-ç›‘æ§è½¯ä»¶/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ç›‘æ§</p>
<h1 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h1><p>prometheus vs zabbix</p>
<p>å…ˆå¯¹ä¸¤è€…çš„å„è‡ªç‰¹ç‚¹è¿›è¡Œä¸€ä¸‹å¯¹æ¯”ï¼š</p>
<table>
<thead>
<tr>
<th>Zabbix</th>
<th>Prometheus</th>
</tr>
</thead>
<tbody>
<tr>
<td>åç«¯ç”¨ C å¼€å‘ï¼Œç•Œé¢ç”¨ PHP å¼€å‘ï¼Œå®šåˆ¶åŒ–éš¾åº¦å¾ˆé«˜ã€‚</td>
<td>åç«¯ç”¨ golang å¼€å‘ï¼Œå‰ç«¯æ˜¯ Grafanaï¼ŒJSON ç¼–è¾‘å³å¯è§£å†³ã€‚å®šåˆ¶åŒ–éš¾åº¦è¾ƒä½ã€‚</td>
</tr>
<tr>
<td>é›†ç¾¤è§„æ¨¡ä¸Šé™ä¸º 10000 ä¸ªèŠ‚ç‚¹ã€‚</td>
<td>æ”¯æŒæ›´å¤§çš„é›†ç¾¤è§„æ¨¡ï¼Œé€Ÿåº¦ä¹Ÿæ›´å¿«ã€‚</td>
</tr>
<tr>
<td>æ›´é€‚åˆç›‘æ§ç‰©ç†æœºç¯å¢ƒã€‚</td>
<td>æ›´é€‚åˆäº‘ç¯å¢ƒçš„ç›‘æ§ï¼Œå¯¹ OpenStackï¼Œ<strong>Kubernetes</strong> æœ‰æ›´å¥½çš„é›†æˆã€‚</td>
</tr>
<tr>
<td>ç›‘æ§æ•°æ®å­˜å‚¨åœ¨å…³ç³»å‹æ•°æ®åº“å†…ï¼Œå¦‚ MySQLï¼Œå¾ˆéš¾ä»ç°æœ‰æ•°æ®ä¸­æ‰©å±•ç»´åº¦ã€‚</td>
<td>ç›‘æ§æ•°æ®å­˜å‚¨åœ¨åŸºäº<strong>æ—¶é—´åºåˆ—(TSDB)</strong>çš„æ•°æ®åº“å†…ï¼Œä¾¿äºå¯¹å·²æœ‰æ•°æ®è¿›è¡Œæ–°çš„èšåˆã€‚</td>
</tr>
<tr>
<td>å®‰è£…ç®€å•ï¼Œzabbix-server ä¸€ä¸ªè½¯ä»¶åŒ…ä¸­åŒ…æ‹¬äº†æ‰€æœ‰çš„æœåŠ¡ç«¯åŠŸèƒ½ã€‚</td>
<td>å®‰è£…ç›¸å¯¹å¤æ‚ï¼Œ<strong>ç›‘æ§ã€å‘Šè­¦å’Œç•Œé¢</strong>éƒ½åˆ†å±äºä¸åŒçš„ç»„ä»¶ã€‚</td>
</tr>
<tr>
<td><strong>å›¾å½¢åŒ–ç•Œé¢</strong>æ¯”è¾ƒæˆç†Ÿï¼Œç•Œé¢ä¸ŠåŸºæœ¬ä¸Šèƒ½å®Œæˆå…¨éƒ¨çš„é…ç½®æ“ä½œã€‚</td>
<td>ç•Œé¢ç›¸å¯¹è¾ƒå¼±ï¼Œå¾ˆå¤šé…ç½®éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td>å‘å±•æ—¶é—´æ›´é•¿ï¼Œå¯¹äºå¾ˆå¤šç›‘æ§åœºæ™¯ï¼Œéƒ½æœ‰ç°æˆçš„è§£å†³æ–¹æ¡ˆã€‚</td>
<td>2015 å¹´åå¼€å§‹å¿«é€Ÿå‘å±•ï¼Œä½†å‘å±•æ—¶é—´è¾ƒçŸ­ï¼Œæˆç†Ÿåº¦ä¸åŠ Zabbixã€‚</td>
</tr>
</tbody>
</table>
<p>ç”±äºæœ€åæ•²å®šäº†Prometheusæ–¹æ¡ˆï¼Œå¯¹äºzabbixå°±äº‘è¯„æµ‹äº†ï¼Œæ¬¢è¿æŒ‡æ­£</p>
<ul>
<li>è™½ç„¶å›¾å½¢åŒ–ç•Œé¢å¼±åŒ–ï¼Œå¾ˆå¤šé…ç½®èµ°ymlæ–‡ä»¶ï¼Œä½†å›¾å½¢åŒ–ç•Œé¢çœŸçš„æ²¡æœ‰å¿…è¦</li>
<li>æ—¶åºæ•°æ®åº“ï¼Œé«˜å¹¶å‘ä¸‹å¥½äºmysqlï¼ˆä¸ç„¶å¹²å˜›å¼€å‘tsdbåº”å¯¹ç›‘æ§åœºæ™¯ï¼‰</li>
<li>promæ”¯æŒpullå’Œpushæ¨¡å‹ï¼Œå¯ä»¥æ”¯æŒk8sï¼Œswarmç­‰æœåŠ¡å‘ç°</li>
</ul>
<h1 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h1><p>Performanceï¼ŸwebVitalsï¼Ÿä»¥åç”¨åˆ°å†è¡¥å……</p>
<p>ä¸»è¦å…³æ³¨æ€§èƒ½ï¼Œpvï¼Œredirectï¼Œerrç­‰é—®é¢˜</p>
<h1 id="é¡µé¢æ˜¯å¦å¯ç”¨"><a href="#é¡µé¢æ˜¯å¦å¯ç”¨" class="headerlink" title="é¡µé¢æ˜¯å¦å¯ç”¨"></a>é¡µé¢æ˜¯å¦å¯ç”¨</h1><p>é˜¿é‡Œäº‘-äº‘ç›‘æ§æ§åˆ¶å°</p>
<p>å¯æä¾›ç½‘å€ç›‘æ§ï¼ŒåŒ…æ‹¬cookie, headers ç­‰è‡ªå®šä¹‰çš„ç®€å•é…ç½®ï¼Œè¿›è¡Œç”µè¯ï¼Œé‚®ä»¶ï¼ŒçŸ­ä¿¡ï¼Œæ—ºæ—ºç­‰æŠ¥è­¦</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zehai.info/2020/05/12/2020-05-12-paddle/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
      <meta itemprop="name" content="Zhang Zehai">
      <meta itemprop="description" content="ä¼šåšé¥­çš„å¨å­">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zehai'blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/12/2020-05-12-paddle/" class="post-title-link" itemprop="url">pandle</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-05-12 16:18:55" itemprop="dateCreated datePublished" datetime="2020-05-12T16:18:55+08:00">2020-05-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 09:40:04" itemprop="dateModified" datetime="2020-05-30T09:40:04+08:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/pandle/" itemprop="url" rel="index"><span itemprop="name">pandle</span></a>
                </span>
            </span>

          
            <span id="/2020/05/12/2020-05-12-paddle/" class="post-meta-item leancloud_visitors" data-flag-title="pandle" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/05/12/2020-05-12-paddle/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/05/12/2020-05-12-paddle/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="start"><a href="#start" class="headerlink" title="start"></a>start</h1><p>use docker</p>
<h1 id="platform"><a href="#platform" class="headerlink" title="platform"></a>platform</h1><ul>
<li><strong>AI Studio</strong>ï¼š<a href="https://aistudio.baidu.com/" target="_blank" rel="noopener">https://aistudio.baidu.com/</a></li>
<li><strong>é£æ¡¨å®˜ç½‘</strong>ï¼š<a href="https://www.paddlepaddle.org.cn/" target="_blank" rel="noopener">https://www.paddlepaddle.org.cn/</a></li>
<li><strong>ç™¾åº¦æŠ€æœ¯å­¦é™¢</strong>ï¼š<a href="http://bit.baidu.com/index" target="_blank" rel="noopener">http://bit.baidu.com/index</a></li>
</ul>
<h1 id="about"><a href="#about" class="headerlink" title="about"></a>about</h1><p>äººå·¥æ™ºèƒ½&gt;æœºå™¨å­¦ä¹ &gt;æ·±åº¦å­¦ä¹ </p>
<ul>
<li><p>äººå·¥æ™ºèƒ½æ˜¯ç ”å‘ç”¨äºæ¨¡æ‹Ÿã€å»¶ä¼¸å’Œæ‰©å±•äººçš„æ™ºèƒ½çš„ç†è®ºã€æ–¹æ³•ã€æŠ€æœ¯åŠåº”ç”¨ç³»ç»Ÿçš„ä¸€é—¨æ–°çš„æŠ€æœ¯ç§‘å­¦ã€‚ç”±äºè¿™ä¸ªå®šä¹‰åªé˜è¿°äº†ç›®æ ‡ï¼Œè€Œæ²¡æœ‰é™å®šæ–¹æ³•ï¼Œå› æ­¤å®ç°äººå·¥æ™ºèƒ½å­˜åœ¨çš„è¯¸å¤šæ–¹æ³•å’Œåˆ†æ”¯ï¼Œå¯¼è‡´å…¶å˜æˆä¸€ä¸ªâ€œå¤§æ‚çƒ©â€å¼çš„å­¦ç§‘ã€‚</p>
</li>
<li><p>æœºå™¨å­¦ä¹ ã€å°¤å…¶æ˜¯ç›‘ç£å­¦ä¹ åˆ™æœ‰æ›´åŠ æ˜ç¡®çš„æŒ‡ä»£ã€‚æœºå™¨å­¦ä¹ æ˜¯ä¸“é—¨ç ”ç©¶è®¡ç®—æœºæ€æ ·æ¨¡æ‹Ÿæˆ–å®ç°äººç±»çš„å­¦ä¹ è¡Œä¸ºï¼Œä»¥è·å–æ–°çš„çŸ¥è¯†æˆ–æŠ€èƒ½ï¼Œé‡æ–°ç»„ç»‡å·²æœ‰çš„çŸ¥è¯†ç»“æ„ï¼Œä½¿ä¹‹ä¸æ–­æ”¹å–„è‡ªèº«çš„æ€§èƒ½</p>
</li>
<li><p>å¤šæ•°æœºå™¨å­¦ä¹ ä»»åŠ¡éƒ½å¯ä»¥ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹è§£å†³ï¼Œå°¤å…¶åœ¨åœ¨è¯­éŸ³ã€è®¡ç®—æœºè§†è§‰å’Œè‡ªç„¶è¯­è¨€å¤„ç†ç­‰é¢†åŸŸï¼Œæ·±åº¦å­¦ä¹ æ¨¡å‹çš„æ•ˆæœæ¯”ä¼ ç»Ÿæœºå™¨å­¦ä¹ ç®—æ³•æœ‰æ˜¾è‘—æå‡ã€‚</p>
<p>é‚£ä¹ˆç›¸æ¯”ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œæ·±åº¦å­¦ä¹ åšå‡ºäº†æ”¹è¿›ï¼Œ<strong>ä¸¤è€…åœ¨ç†è®ºç»“æ„ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œå³ï¼šæ¨¡å‹å‡è®¾ã€è¯„ä»·å‡½æ•°å’Œä¼˜åŒ–ç®—æ³•ï¼Œå…¶æ ¹æœ¬å·®åˆ«åœ¨äºå‡è®¾çš„å¤æ‚åº¦</strong></p>
</li>
</ul>
<p>äººå·¥ç¥ç»ç½‘ç»œåŒ…æ‹¬å¤šä¸ªç¥ç»ç½‘ç»œå±‚ï¼Œå¦‚å·ç§¯å±‚ã€å…¨è¿æ¥å±‚ã€LSTMç­‰ï¼Œæ¯ä¸€å±‚åˆåŒ…æ‹¬å¾ˆå¤šç¥ç»å…ƒï¼Œè¶…è¿‡ä¸‰å±‚çš„éçº¿æ€§ç¥ç»ç½‘ç»œéƒ½å¯ä»¥è¢«ç§°ä¸ºæ·±åº¦ç¥ç»ç½‘ç»œã€‚é€šä¿—çš„è®²ï¼Œæ·±åº¦å­¦ä¹ çš„æ¨¡å‹å¯ä»¥è§†ä¸ºæ˜¯è¾“å…¥åˆ°è¾“å‡ºçš„æ˜ å°„å‡½æ•°ï¼Œå¦‚å›¾åƒåˆ°é«˜çº§è¯­ä¹‰ï¼ˆç¾å¥³ï¼‰çš„æ˜ å°„ï¼Œè¶³å¤Ÿæ·±çš„ç¥ç»ç½‘ç»œç†è®ºä¸Šå¯ä»¥æ‹Ÿåˆä»»ä½•å¤æ‚çš„å‡½æ•°ã€‚å› æ­¤ç¥ç»ç½‘ç»œéå¸¸é€‚åˆå­¦ä¹ æ ·æœ¬æ•°æ®çš„å†…åœ¨è§„å¾‹å’Œè¡¨ç¤ºå±‚æ¬¡ï¼Œå¯¹æ–‡å­—ã€å›¾åƒå’Œè¯­éŸ³ä»»åŠ¡æœ‰å¾ˆå¥½çš„é€‚ç”¨æ€§ã€‚å› ä¸ºè¿™å‡ ä¸ªé¢†åŸŸçš„ä»»åŠ¡æ˜¯äººå·¥æ™ºèƒ½çš„åŸºç¡€æ¨¡å—ï¼Œæ‰€ä»¥æ·±åº¦å­¦ä¹ è¢«ç§°ä¸ºå®ç°äººå·¥æ™ºèƒ½çš„åŸºç¡€ä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ã€‚</p>
<ul>
<li>ç¥ç»å…ƒï¼šç¥ç»ç½‘ç»œä¸­æ¯ä¸ªèŠ‚ç‚¹ç§°ä¸ºç¥ç»å…ƒï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š<ul>
<li>åŠ æƒå’Œï¼šå°†æ‰€æœ‰è¾“å…¥åŠ æƒæ±‚å’Œã€‚</li>
<li>éçº¿æ€§å˜æ¢ï¼ˆæ¿€æ´»å‡½æ•°ï¼‰ï¼šåŠ æƒå’Œçš„ç»“æœç»è¿‡ä¸€ä¸ªéçº¿æ€§å‡½æ•°å˜æ¢ï¼Œè®©ç¥ç»å…ƒè®¡ç®—å…·å¤‡éçº¿æ€§çš„èƒ½åŠ›ã€‚</li>
</ul>
</li>
<li><strong>å¤šå±‚è¿æ¥ï¼š</strong> å¤§é‡è¿™æ ·çš„èŠ‚ç‚¹æŒ‰ç…§ä¸åŒçš„å±‚æ¬¡æ’å¸ƒï¼Œå½¢æˆå¤šå±‚çš„ç»“æ„è¿æ¥èµ·æ¥ï¼Œå³ç§°ä¸ºç¥ç»ç½‘ç»œã€‚</li>
<li><strong>å‰å‘è®¡ç®—ï¼š</strong> ä»è¾“å…¥è®¡ç®—è¾“å‡ºçš„è¿‡ç¨‹ï¼Œé¡ºåºä»ç½‘ç»œå‰è‡³åã€‚</li>
<li><strong>è®¡ç®—å›¾ï¼š</strong> ä»¥å›¾å½¢åŒ–çš„æ–¹å¼å±•ç°ç¥ç»ç½‘ç»œçš„è®¡ç®—é€»è¾‘åˆæˆä¸ºè®¡ç®—å›¾ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ç¥ç»ç½‘ç»œçš„è®¡ç®—å›¾ä»¥å…¬å¼çš„æ–¹å¼è¡¨è¾¾å¦‚ä¸‹ï¼š</li>
</ul>
<p>ç”±æ­¤å¯è§ï¼Œç¥ç»ç½‘ç»œå¹¶æ²¡æœ‰é‚£ä¹ˆç¥ç§˜ï¼Œå®ƒçš„æœ¬è´¨æ˜¯ä¸€ä¸ªå«æœ‰å¾ˆå¤šå‚æ•°çš„â€œå¤§å…¬å¼â€ã€‚</p>
<p>æ·±åº¦å­¦ä¹ æ¡†æ¶æ ‡å‡†åŒ–ï¼Œè‡ªåŠ¨åŒ–ï¼Œæ¨¡å—åŒ–</p>
<p>æ•°æ®å¤„ç†-&gt;æ¨¡å‹è®¾è®¡-&gt;è®­ç»ƒé…ç½®-&gt;è®­ç»ƒè¿‡ç¨‹-&gt;æ¨¡å‹ä¿å­˜</p>
<ul>
<li>æ•°æ®å¤„ç†ï¼šæ•°æ®å¯¼å…¥â€“&gt;æ•°æ®å½¢çŠ¶å˜æ¢â€“&gt;æ•°æ®é›†åˆ’åˆ†â€“&gt;æ•°æ®å½’ä¸€åŒ–å¤„ç†â€“&gt;å°è£…load dataæ•°æ®â€“&gt;æ•°æ®é¢„å¤„ç†â€“&gt;æ¨¡å‹è°ƒç”¨</li>
</ul>
<h1 id="æ„å»ºç¥ç»ç½‘ç»œæ¨¡å‹"><a href="#æ„å»ºç¥ç»ç½‘ç»œæ¨¡å‹" class="headerlink" title="æ„å»ºç¥ç»ç½‘ç»œæ¨¡å‹"></a>æ„å»ºç¥ç»ç½‘ç»œæ¨¡å‹</h1><p>ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µï¼ˆå¦‚ç¥ç»å…ƒã€å¤šå±‚è¿æ¥ã€å‰å‘è®¡ç®—ã€è®¡ç®—å›¾ï¼‰å’Œæ¨¡å‹ç»“æ„ä¸‰è¦ç´ ï¼ˆæ¨¡å‹å‡è®¾ã€è¯„ä»·å‡½æ•°å’Œä¼˜åŒ–ç®—æ³•ï¼‰</p>
<p>è¿ç»­â€“&gt;å›å½’ä»»åŠ¡</p>
<p>ç¦»æ•£â€“&gt;åˆ†ç±»ä»»åŠ¡</p>
<p>æ•°æ®å¤„ç†ï¼ˆæ•°æ®å¯¼å…¥ã€æ•°æ®å½¢çŠ¶å˜æ¢ã€æ•°æ®é›†åˆ’åˆ†ã€æ•°æ®å½’ä¸€åŒ–å¤„ç†ï¼Œå°è£…load dataå‡½æ•°ï¼‰-&gt;æ¨¡å‹è®¾è®¡-&gt;è®­ç»ƒé…ç½®-&gt;è®­ç»ƒè¿‡ç¨‹-&gt;æ¨¡å‹ä¿å­˜</p>
<h2 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><p>1.æ•°æ®å¯¼å…¥</p>
<p>2.æ•°æ®å½¢çŠ¶å˜æ¢ï¼ˆ1ç»´æ•°æ®æ”¹æˆå¯ç”¨å½¢å¼ï¼‰</p>
<p>3.æ•°æ®é›†åˆ’åˆ†ï¼Œåˆ’åˆ†è®­ç»ƒé›†ï¼Œæµ‹è¯•é›†</p>
<p>4.æ•°æ®å½’ä¸€åŒ–ï¼ˆç‰¹å¾å€¼0ï½1ï¼‰</p>
<p>5.å°è£…load dataå‡½æ•°</p>
<h2 id="æ¨¡å‹è®¾è®¡"><a href="#æ¨¡å‹è®¾è®¡" class="headerlink" title="æ¨¡å‹è®¾è®¡"></a>æ¨¡å‹è®¾è®¡</h2><p>æ¨¡å‹è®¾è®¡æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹å…³é”®è¦ç´ ä¹‹ä¸€ï¼Œä¹Ÿç§°ä¸ºç½‘ç»œç»“æ„è®¾è®¡ï¼Œç›¸å½“äºæ¨¡å‹çš„å‡è®¾ç©ºé—´ï¼Œå³å®ç°æ¨¡å‹â€œå‰å‘è®¡ç®—â€ï¼ˆä»è¾“å…¥åˆ°è¾“å‡ºï¼‰çš„è¿‡ç¨‹ã€‚</p>
<h2 id="æç£ä¸‹é™ç®—æ³•"><a href="#æç£ä¸‹é™ç®—æ³•" class="headerlink" title="æç£ä¸‹é™ç®—æ³•"></a>æç£ä¸‹é™ç®—æ³•</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zehai.info/2020/04/30/2020-04-30-prom-client/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
      <meta itemprop="name" content="Zhang Zehai">
      <meta itemprop="description" content="ä¼šåšé¥­çš„å¨å­">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zehai'blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/30/2020-04-30-prom-client/" class="post-title-link" itemprop="url">prom-client</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-30 16:18:55" itemprop="dateCreated datePublished" datetime="2020-04-30T16:18:55+08:00">2020-04-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 09:40:04" itemprop="dateModified" datetime="2020-05-30T09:40:04+08:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/prometheus/" itemprop="url" rel="index"><span itemprop="name">prometheus</span></a>
                </span>
            </span>

          
            <span id="/2020/04/30/2020-04-30-prom-client/" class="post-meta-item leancloud_visitors" data-flag-title="prom-client" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/04/30/2020-04-30-prom-client/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/04/30/2020-04-30-prom-client/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>prom-clinet</p>
<p>prometheusçš„clientï¼Œæ”¯æŒhistogram summaries gauges counters</p>
<h1 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h1><ul>
<li>clusteræ¨¡å¼,é¿å…å„ä¸ªworkeréƒ½æœ‰ä¸€ä¸ªmetric</li>
<li>éclusteræ¨¡å¼ï¼Œå…¨å±€æŒ‚è½½</li>
</ul>
<h1 id="api"><a href="#api" class="headerlink" title="api"></a>api</h1><h2 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h2><p>æ‰€æœ‰metricéƒ½æœ‰ä¸¤ä¸ªå¼ºåˆ¶å±æ€§</p>
<ul>
<li>name</li>
<li>helpï¼ˆæè¿°ï¼‰</li>
</ul>
<h2 id="DefaultMetrics"><a href="#DefaultMetrics" class="headerlink" title="DefaultMetrics"></a>DefaultMetrics</h2><p>collectDefaultMetrics({options})</p>
<p>Options ï¼ˆObjectï¼‰å…·å¤‡ä»¥ä¸‹å››ä¸ªå‚æ•°</p>
<ul>
<li>prefixï¼šmetricæ·»åŠ å‰ç¼€ ï¼Œé»˜è®¤æ²¡æœ‰å‰ç¼€ï¼ˆjob instanceåæ›´åŠ ç»†åˆ†ï¼‰</li>
<li>registry:æŒ‡å‘å“ªä¸ªregisterï¼Œé»˜è®¤å…¨å±€</li>
<li>gcDurationBuckets è‡ªå®šä¹‰bucketsçš„gcæŒç»­æ—¶é—´ç›´æ–¹å›¾ï¼Œé»˜è®¤[0.001, 0.01, 0.1, 1, 2, 5]` (in seconds).</li>
<li>eventLoopMonitoringPrecision é‡‡æ ·ç‡ä»¥æ¯«ç§’ä¸ºå•ä½ï¼ˆ&gt;0ï¼‰ï¼Œé»˜è®¤10</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> collectDefaultMetrics = client.collectDefaultMetrics;</span><br><span class="line"><span class="keyword">const</span> Registry = client.Registry;</span><br><span class="line"><span class="keyword">const</span> register = <span class="keyword">new</span> Registry();</span><br><span class="line"><span class="keyword">const</span> prefix = <span class="string">'my_application_'</span>;</span><br><span class="line"></span><br><span class="line">collectDefaultMetrics(&#123; register,prefix,<span class="attr">gcDurationBuckets</span>: [<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.3</span>] &#125;);</span><br></pre></td></tr></table></figure>
<h2 id="counter"><a href="#counter" class="headerlink" title="counter"></a>counter</h2><p>å½“è¿›ç¨‹é‡å¯æ—¶ï¼Œcounterä¼šæ¸…ç©ºï¼Œä½¿ç”¨å‡½æ•°è§£å†³</p>
<p>ä½œè€…æ³¨ï¼š</p>
<ul>
<li>å¯ä»¥ç›‘æ§æŒ‰é’®ç‚¹å‡»æ¬¡æ•°ï¼Œè¯·æ±‚æ¬¡æ•°æ¥ç›‘æ§ä¸šåŠ¡æ•°æ®</li>
<li>åŒæ—¶ä¹Ÿ<strong>æ”¯æŒlabelNames</strong>ï¼Œå‚è€ƒHistogram</li>
<li>ä»0å¼€å§‹å¢ï¼Œ<strong>ä¸å¯å‡</strong>ï¼Œï¼ˆå‡-&gt;gaugeï¼‰</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"><span class="keyword">const</span> counter = <span class="keyword">new</span> client.Counter(&#123;</span><br><span class="line">  name: <span class="string">'metric_name'</span>,</span><br><span class="line">  help: <span class="string">'metric_help'</span>,</span><br><span class="line">&#125;);</span><br><span class="line">counter.inc(); <span class="comment">// Inc with 1</span></span><br><span class="line">counter.inc(<span class="number">10</span>); <span class="comment">// Inc with 10</span></span><br></pre></td></tr></table></figure>
<h2 id="gauge"><a href="#gauge" class="headerlink" title="gauge"></a>gauge</h2><p>counteråŠŸèƒ½åŸºç¡€ä¸Šæ”¯æŒå‡æ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//base</span></span><br><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"><span class="keyword">const</span> gauge = <span class="keyword">new</span> client.Gauge(&#123; <span class="attr">name</span>: <span class="string">'metric_name'</span>, <span class="attr">help</span>: <span class="string">'metric_help'</span> &#125;);</span><br><span class="line">gauge.set(<span class="number">10</span>); <span class="comment">// Set to 10</span></span><br><span class="line">gauge.inc(); <span class="comment">// Inc with 1</span></span><br><span class="line">gauge.inc(<span class="number">10</span>); <span class="comment">// Inc with 10</span></span><br><span class="line">gauge.dec(); <span class="comment">// Dec with 1</span></span><br><span class="line">gauge.dec(<span class="number">10</span>); <span class="comment">// Dec with 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//others</span></span><br><span class="line">gauge.setToCurrentTime(); <span class="comment">// Sets value to current time</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> end = gauge.startTimer();</span><br><span class="line">xhrRequest(<span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;</span><br><span class="line">  end(); <span class="comment">// Sets value to xhrRequests duration in seconds</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="histogram"><a href="#histogram" class="headerlink" title="histogram"></a>histogram</h2><p>è¿½è¸ªäº‹ä»¶çš„å¤§å°å’Œé¢‘ç‡</p>
<h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>é»˜è®¤çš„bucketsæ—¨åœ¨è¦†ç›–å¸¸è§„çš„web/rpcè¯·æ±‚ï¼Œä¹Ÿå¯ä»¥è¢«override</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"><span class="keyword">new</span> client.Histogram(&#123;</span><br><span class="line">  name: <span class="string">'metric_name'</span>,</span><br><span class="line">  help: <span class="string">'metric_help'</span>,</span><br><span class="line">  labelNames: [<span class="string">'status_code'</span>],<span class="comment">//**Array**</span></span><br><span class="line">  buckets: [<span class="number">0.1</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">50</span>, <span class="number">100</span>, <span class="number">500</span>],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"><span class="keyword">const</span> histogram = <span class="keyword">new</span> client.Histogram(&#123;</span><br><span class="line">  name: <span class="string">'metric_name'</span>,</span><br><span class="line">  help: <span class="string">'metric_help'</span>,</span><br><span class="line">&#125;);</span><br><span class="line">histogram.observe(<span class="number">10</span>); <span class="comment">// Observe value in histogram</span></span><br></pre></td></tr></table></figure>
<h3 id="Utility-to-observe-request-durations"><a href="#Utility-to-observe-request-durations" class="headerlink" title="Utility to observe request durations"></a>Utility to observe request durations</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> end = histogram.startTimer();</span><br><span class="line">xhrRequest(<span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> seconds = end(); <span class="comment">// Observes and returns the value to xhrRequests duration in seconds</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="summary"><a href="#summary" class="headerlink" title="summary"></a>summary</h2><p>è®¡ç®—è§‚å¯Ÿå€¼çš„ç™¾åˆ†æ¯”æ•°æ®</p>
<h3 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h3><p>é»˜è®¤ç™¾åˆ†æ¯”[0.01, 0.05, 0.5, 0.9, 0.95, 0.99, 0.999]ï¼Œä½†å¯ä»¥è¢«è¦†ç›–</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"><span class="keyword">new</span> client.Summary(&#123;</span><br><span class="line">  name: <span class="string">'metric_name'</span>,</span><br><span class="line">  help: <span class="string">'metric_help'</span>,</span><br><span class="line">  percentiles: [<span class="number">0.01</span>, <span class="number">0.1</span>, <span class="number">0.9</span>, <span class="number">0.99</span>],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå¯ç”¨æ»‘åŠ¨çª—å£åŠŸèƒ½ï¼Œéœ€è¦æ–°å¢<code>maxAgeSeconds</code> and <code>ageBuckets</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"><span class="keyword">new</span> client.Summary(&#123;</span><br><span class="line">  name: <span class="string">'metric_name'</span>,</span><br><span class="line">  help: <span class="string">'metric_help'</span>,</span><br><span class="line">  maxAgeSeconds: <span class="number">600</span>,</span><br><span class="line">  ageBuckets: <span class="number">5</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>maxAgeSeconds å¯ä»¥çŸ¥é“bucketé‡åˆ¶å‰çš„ä½¿ç”¨æ—¶å¸¸</p>
<p>ageBuckets æ»‘åŠ¨çª—å£ä¸­æœ€å¤šçš„bucketsæ•°ç›®</p>
<h3 id="Usage-example"><a href="#Usage-example" class="headerlink" title="Usage example"></a>Usage example</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"><span class="keyword">const</span> summary = <span class="keyword">new</span> client.Summary(&#123;</span><br><span class="line">  name: <span class="string">'metric_name'</span>,</span><br><span class="line">  help: <span class="string">'metric_help'</span>,</span><br><span class="line">&#125;);</span><br><span class="line">summary.observe(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Utility-to-observe-request-durations-1"><a href="#Utility-to-observe-request-durations-1" class="headerlink" title="Utility to observe request durations"></a>Utility to observe request durations</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> end = summary.startTimer();</span><br><span class="line">xhrRequest(<span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;</span><br><span class="line">  end(); <span class="comment">// Observes the value to xhrRequests duration in seconds</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="labels"><a href="#labels" class="headerlink" title="labels"></a>labels</h2><p>æ‰€æœ‰metricså¯ä»¥è®¾ç½®labelNameså±æ€§ï¼Œä¸¤ç§èµ‹å€¼æ–¹å¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"><span class="keyword">const</span> gauge = <span class="keyword">new</span> client.Gauge(&#123;</span><br><span class="line">  name: <span class="string">'metric_name'</span>,</span><br><span class="line">  help: <span class="string">'metric_help'</span>,</span><br><span class="line">  labelNames: [<span class="string">'method'</span>, <span class="string">'statusCode'</span>],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gauge.set(&#123; <span class="attr">method</span>: <span class="string">'GET'</span>, <span class="attr">statusCode</span>: <span class="string">'200'</span> &#125;, <span class="number">100</span>); <span class="comment">// 1st version, Set value 100 with method set to GET and statusCode to 200</span></span><br><span class="line">gauge.labels(<span class="string">'GET'</span>, <span class="string">'200'</span>).set(<span class="number">100</span>); <span class="comment">// 2nd version, Same as above</span></span><br></pre></td></tr></table></figure>
<p>ç”¨æ¥è®°å½•è¯·æ±‚ç»“æœ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> end = startTimer(&#123; <span class="attr">method</span>: <span class="string">'GET'</span> &#125;); <span class="comment">// Set method to GET, we don't know statusCode yet</span></span><br><span class="line">xhrRequest(<span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    end(&#123; <span class="attr">statusCode</span>: <span class="string">'500'</span> &#125;); <span class="comment">// Sets value to xhrRequest duration in seconds with statusCode 500</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    end(&#123; <span class="attr">statusCode</span>: <span class="string">'200'</span> &#125;); <span class="comment">// Sets value to xhrRequest duration in seconds with statusCode 200</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="default-labels"><a href="#default-labels" class="headerlink" title="default labels"></a>default labels</h3><h1 id="gc"><a href="#gc" class="headerlink" title="gc"></a>gc</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zehai.info/2020/04/30/2020-04-30-prometheus/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
      <meta itemprop="name" content="Zhang Zehai">
      <meta itemprop="description" content="ä¼šåšé¥­çš„å¨å­">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zehai'blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/30/2020-04-30-prometheus/" class="post-title-link" itemprop="url">prometheus</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-30 16:18:55" itemprop="dateCreated datePublished" datetime="2020-04-30T16:18:55+08:00">2020-04-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 09:40:04" itemprop="dateModified" datetime="2020-05-30T09:40:04+08:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/prometheus/" itemprop="url" rel="index"><span itemprop="name">prometheus</span></a>
                </span>
            </span>

          
            <span id="/2020/04/30/2020-04-30-prometheus/" class="post-meta-item leancloud_visitors" data-flag-title="prometheus" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/04/30/2020-04-30-prometheus/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/04/30/2020-04-30-prometheus/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><h1 id="2-Concepts"><a href="#2-Concepts" class="headerlink" title="2.Concepts"></a>2.Concepts</h1><h1 id="3-Prometheus"><a href="#3-Prometheus" class="headerlink" title="3. Prometheus"></a>3. Prometheus</h1><h1 id="4-Visualization"><a href="#4-Visualization" class="headerlink" title="4.Visualization"></a>4.Visualization</h1><h1 id="5-Operating"><a href="#5-Operating" class="headerlink" title="5.Operating"></a>5.Operating</h1><h2 id="5-1security"><a href="#5-1security" class="headerlink" title="5.1security"></a>5.1security</h2><p>promethueså…·å¤‡å¾ˆå¤šç»„ä»¶ï¼Œä»¥åŠä¸å…¶ä»–ç³»ç»Ÿé›†æˆï¼Œæœ¬èº«<strong>å¯ä»¥</strong>éƒ¨ç½²åœ¨å—ä¿¡ä»»å’Œä¸å—ä¿¡ä»»çš„ç¯å¢ƒ</p>
<h3 id="5-1-1-Promethues"><a href="#5-1-1-Promethues" class="headerlink" title="5.1.1 Promethues"></a>5.1.1 Promethues</h3><h3 id="5-1-2-AlertManager"><a href="#5-1-2-AlertManager" class="headerlink" title="5.1.2 AlertManager"></a>5.1.2 AlertManager</h3><h3 id="5-1-3-Pushgateway"><a href="#5-1-3-Pushgateway" class="headerlink" title="5.1.3 Pushgateway"></a>5.1.3 Pushgateway</h3><h3 id="5-1-4-Exporters"><a href="#5-1-4-Exporters" class="headerlink" title="5.1.4 Exporters"></a>5.1.4 Exporters</h3><h3 id="5-1-5-Client-Libraries"><a href="#5-1-5-Client-Libraries" class="headerlink" title="5.1.5 Client Libraries"></a>5.1.5 Client Libraries</h3><h3 id="5-1-6-Auth-and-encrytion"><a href="#5-1-6-Auth-and-encrytion" class="headerlink" title="5.1.6 Auth and encrytion"></a>5.1.6 Auth and encrytion</h3><p>prometheus åŠå…¶ç»„å»ºä¸æä¾›ä»»ä½•èº«ä»½éªŒè¯ï¼ˆserver-side authenticationï¼‰,æˆæƒï¼ˆauthorizationï¼‰ ,åŠ å¯†ï¼ˆencryptionï¼‰</p>
<p>å¦‚æœéœ€è¦ï¼Œå»ºè®®é‡‡ç”¨<code>åå‘ä»£ç†</code></p>
<ul>
<li><p>åœ¨ç®¡ç†æˆ–è€…mutating endpoints ä½¿ç”¨ç®€å•çš„è®¿é—®å·¥å…·ï¼ˆå¦‚cURLï¼‰è®¿é—®ï¼Œç”±äºpromæ²¡æœ‰å†…ç½®çš„csrfä¿æŠ¤æ¨¡å—ï¼Œæ‰€ä»¥ä¼šç ´åç±»ç”¨ä¾‹ï¼ˆbreak such use casesï¼‰,å› æ­¤ä½¿ç”¨åå‘ä»£ç†ï¼Œå¯ä»¥é¿å…csrfæ”»å‡»</p>
</li>
<li><p>å¯¹äºémutating endpoints ï¼Œä½ å¯ä»¥ä½¿ç”¨cors headers ï¼ˆå¦‚<code>Access-Control-Allow-Origin</code>ï¼‰æ¥é¿å…xssæ”»å‡»</p>
</li>
<li><p>å¯¹äºéä¿¡ä»»ç”¨æˆ·ï¼Œä½¿ç”¨è½¬è¯‘</p>
</li>
<li>å¯¹äºgrafanaï¼Œåšå¥½æƒé™ç›‘æ§ï¼Œä¸è¦é™åˆ¶ä½¿ç”¨ä»£ç†æ–¹å¼è¿è¡ŒæŸ¥è¯¢è¯­å¥çš„æƒé™</li>
</ul>
<h3 id="5-1-7-Secrets"><a href="#5-1-7-Secrets" class="headerlink" title="5.1.7 Secrets"></a>5.1.7 Secrets</h3><h3 id="5-1-8-Denial-of-Service"><a href="#5-1-8-Denial-of-Service" class="headerlink" title="5.1.8 Denial of Service"></a>5.1.8 Denial of Service</h3><h3 id="5-1-9-Libraries"><a href="#5-1-9-Libraries" class="headerlink" title="5.1.9 Libraries"></a>5.1.9 Libraries</h3><h3 id="5-1-10-Build-Process"><a href="#5-1-10-Build-Process" class="headerlink" title="5.1.10 Build Process"></a>5.1.10 Build Process</h3><h3 id="5-1-11-External-audits"><a href="#5-1-11-External-audits" class="headerlink" title="5.1.11 External audits"></a>5.1.11 External audits</h3><h2 id="5-2-Integrations"><a href="#5-2-Integrations" class="headerlink" title="5.2 Integrations"></a>5.2 Integrations</h2><h1 id="6-Instrumenting"><a href="#6-Instrumenting" class="headerlink" title="6.Instrumenting"></a>6.Instrumenting</h1><h1 id="7-Alerting"><a href="#7-Alerting" class="headerlink" title="7.Alerting"></a>7.Alerting</h1><h1 id="8-Best-Practices"><a href="#8-Best-Practices" class="headerlink" title="8.Best Practices"></a>8.Best Practices</h1><h2 id="8-4-Histograms-and-summaries"><a href="#8-4-Histograms-and-summaries" class="headerlink" title="8.4 Histograms and summaries"></a>8.4 Histograms and summaries</h2><h3 id="8-4-1-Library-support"><a href="#8-4-1-Library-support" class="headerlink" title="8.4.1 Library support"></a>8.4.1 Library support</h3><p>å®˜æ–¹ï¼šgo java py ruby</p>
<p>è¯‘è€…æ³¨ï¼šç›®å‰nodeé€šè¿‡prom-clientä¹Ÿå¯ä»¥ä½¿ç”¨</p>
<h3 id="8-4-2-Count-and-sum-of-observations"><a href="#8-4-2-Count-and-sum-of-observations" class="headerlink" title="8.4.2 Count and sum of observations"></a>8.4.2 Count and sum of observations</h3><p>ä¸¤è€…éƒ½æ˜¯æ ·æœ¬è§‚å¯Ÿï¼Œè¯·æ±‚æŒç»­æ—¶é—´æˆ–è€…å“åº”å¤§å°ï¼Œè§‚å¯Ÿvalueï¼Œæ±‚å’Œï¼Œè®¡ç®—å¹³å‡å€¼</p>
<p>å¯ä»¥ä½¿ç”¨summaries &amp; histogramè®¡ç®—è´Ÿå€¼ï¼ˆå¦‚æ¸©åº¦ï¼‰ï¼Œä¸”æ— æ³•ä½¿ç”¨rate</p>
<p>è®¡ç®—5minä¸­å†…çš„è¯·æ±‚æŒç»­æ—¶é—´ï¼Œå¹³å‡å€¼çš„hisogram or summary</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rate(http_request_duration_seconds_sum[<span class="number">5</span>m])/rate(http_request_duration_seconds_count[<span class="number">5</span>m])</span><br></pre></td></tr></table></figure>
<h3 id="8-4-3-Apdex-score"><a href="#8-4-3-Apdex-score" class="headerlink" title="8.4.3 Apdex score"></a>8.4.3 Apdex score</h3><p>Apex =Application Performance Index</p>
<h3 id="8-4-4-Quantiles"><a href="#8-4-4-Quantiles" class="headerlink" title="8.4.4 Quantiles"></a>8.4.4 Quantiles</h3><h3 id="8-4-5-Errors-of-quantile-estimation"><a href="#8-4-5-Errors-of-quantile-estimation" class="headerlink" title="8.4.5 Errors of quantile estimation"></a>8.4.5 Errors of quantile estimation</h3><h3 id="8-4-6-if-no-library-support"><a href="#8-4-6-if-no-library-support" class="headerlink" title="8.4.6 if no library support"></a>8.4.6 if no library support</h3><h1 id="9-Guides"><a href="#9-Guides" class="headerlink" title="9.Guides"></a>9.Guides</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zehai.info/2020/04/29/2020-04-29-prom-client/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
      <meta itemprop="name" content="Zhang Zehai">
      <meta itemprop="description" content="ä¼šåšé¥­çš„å¨å­">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zehai'blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/29/2020-04-29-prom-client/" class="post-title-link" itemprop="url">prom-client</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-29 16:18:55" itemprop="dateCreated datePublished" datetime="2020-04-29T16:18:55+08:00">2020-04-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 09:33:31" itemprop="dateModified" datetime="2020-05-30T09:33:31+08:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/prometheus/" itemprop="url" rel="index"><span itemprop="name">prometheus</span></a>
                </span>
            </span>

          
            <span id="/2020/04/29/2020-04-29-prom-client/" class="post-meta-item leancloud_visitors" data-flag-title="prom-client" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/04/29/2020-04-29-prom-client/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/04/29/2020-04-29-prom-client/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>prom-client æ”¯æŒnodejsæ”¶é›†metricsï¼Œç›´æ–¹å›¾histogramï¼Œsummariesï¼Œgaugesï¼Œå’Œcounters</p>
<p>prometheusé€šè¿‡pullè·å–nodeæœåŠ¡æ•°æ®</p>
<h2 id="æ”¯æŒcluster"><a href="#æ”¯æŒcluster" class="headerlink" title="æ”¯æŒcluster"></a>æ”¯æŒcluster</h2><h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>æ‰€æœ‰metricæœ‰ä¸¤ä¸ªå¿…å¡«å‚æ•°ï¼Œnameä¸help</p>
<h2 id="é»˜è®¤"><a href="#é»˜è®¤" class="headerlink" title="é»˜è®¤"></a>é»˜è®¤</h2><p>1.<code>collectDefaultMetrics</code>ä¸ºpromæ¨èmetricï¼ˆéƒ¨åˆ†metricä»…åœ¨linuxç”Ÿæ•ˆï¼‰</p>
<p>2.åŒ…å«nodeç‰¹æœ‰çš„metricï¼Œå¦‚eventLoop lagï¼Œactive handlesï¼Œgcï¼Œnode version</p>
<p>3.collectDefaultMetricså¯ä»¥æ¥å—ä»¥ä¸‹å‚æ•°</p>
<ul>
<li>prefixï¼šmetricè‡ªå®šä¹‰å‰ç¼€ï¼Œé»˜è®¤ç©º</li>
<li>registry ï¼šè‡ªå®šä¹‰æ³¨å†Œè¡¨ï¼Œé»˜è®¤global</li>
<li><code>gcDurationBuckets</code></li>
<li><code>eventLoopMonitoringPrecision</code> </li>
</ul>
<h3 id="æ›´æ¢registry"><a href="#æ›´æ¢registry" class="headerlink" title="æ›´æ¢registry"></a>æ›´æ¢registry</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> collectDefaultMetrics = client.collectDefaultMetrics;</span><br><span class="line"><span class="keyword">const</span> Registry = client.Registry;</span><br><span class="line"><span class="keyword">const</span> register = <span class="keyword">new</span> Registry();</span><br><span class="line">collectDefaultMetrics(&#123; register &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="To-use-custom-buckets-for-GC-duration-histogram-pass-it-in-as-gcDurationBuckets"><a href="#To-use-custom-buckets-for-GC-duration-histogram-pass-it-in-as-gcDurationBuckets" class="headerlink" title="To use custom buckets for GC duration histogram, pass it in as gcDurationBuckets:"></a>To use custom buckets for GC duration histogram, pass it in as <code>gcDurationBuckets</code>:</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> collectDefaultMetrics = client.collectDefaultMetrics;</span><br><span class="line"></span><br><span class="line">collectDefaultMetrics(&#123; <span class="attr">gcDurationBuckets</span>: [<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.3</span>] &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="To-prefix-metric-names-with-your-own-arbitrary-string-pass-in-a-prefix"><a href="#To-prefix-metric-names-with-your-own-arbitrary-string-pass-in-a-prefix" class="headerlink" title="To prefix metric names with your own arbitrary string, pass in a prefix:"></a>To prefix metric names with your own arbitrary string, pass in a <code>prefix</code>:</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"><span class="keyword">const</span> collectDefaultMetrics = client.collectDefaultMetrics;</span><br><span class="line"><span class="keyword">const</span> prefix = <span class="string">'my_application_'</span>;</span><br><span class="line">collectDefaultMetrics(&#123; prefix &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="You-can-get-the-full-list-of-metrics-by-inspecting-client-collectDefaultMetrics-metricsList"><a href="#You-can-get-the-full-list-of-metrics-by-inspecting-client-collectDefaultMetrics-metricsList" class="headerlink" title="You can get the full list of metrics by inspecting client.collectDefaultMetrics.metricsList."></a>You can get the full list of metrics by inspecting <code>client.collectDefaultMetrics.metricsList</code>.</h3><p>Default metrics are collected on scrape of metrics endpoint, not on an interval.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> client = <span class="built_in">require</span>(<span class="string">'prom-client'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> collectDefaultMetrics = client.collectDefaultMetrics;</span><br><span class="line"></span><br><span class="line">collectDefaultMetrics();</span><br></pre></td></tr></table></figure>
<h1 id="counter"><a href="#counter" class="headerlink" title="counter"></a>counter</h1><h1 id="Gauge"><a href="#Gauge" class="headerlink" title="Gauge"></a>Gauge</h1><h1 id="Histogram"><a href="#Histogram" class="headerlink" title="Histogram"></a>Histogram</h1><h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><h1 id="Labels"><a href="#Labels" class="headerlink" title="Labels"></a>Labels</h1><h1 id="Multiple-registries"><a href="#Multiple-registries" class="headerlink" title="Multiple registries"></a>Multiple registries</h1><h1 id="Register"><a href="#Register" class="headerlink" title="Register"></a>Register</h1><h1 id="Pushgateway"><a href="#Pushgateway" class="headerlink" title="Pushgateway"></a>Pushgateway</h1><h1 id="Utilities"><a href="#Utilities" class="headerlink" title="Utilities"></a>Utilities</h1><h1 id="GC-stats"><a href="#GC-stats" class="headerlink" title="GC stats"></a>GC stats</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zehai.info/2020/04/22/2020-04-22-Node14/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
      <meta itemprop="name" content="Zhang Zehai">
      <meta itemprop="description" content="ä¼šåšé¥­çš„å¨å­">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zehai'blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/22/2020-04-22-Node14/" class="post-title-link" itemprop="url">Node.JSv14</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-22 10:37:29" itemprop="dateCreated datePublished" datetime="2020-04-22T10:37:29+08:00">2020-04-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 09:33:31" itemprop="dateModified" datetime="2020-05-30T09:33:31+08:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Node/" itemprop="url" rel="index"><span itemprop="name">Node</span></a>
                </span>
            </span>

          
            <span id="/2020/04/22/2020-04-22-Node14/" class="post-meta-item leancloud_visitors" data-flag-title="Node.JSv14" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/04/22/2020-04-22-Node14/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/04/22/2020-04-22-Node14/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="new"><a href="#new" class="headerlink" title="new"></a>new</h1><p>ä»Šå¤©çœ‹åˆ°Node Currentæ›´æ–°äº†14çš„ç‰ˆæœ¬ï¼Œçœ‹çœ‹éƒ½æœ‰äº›ä»€ä¹ˆä¸œè¥¿</p>
<p>å‰ç½®äº†è§£äº†ä¸€ä¸‹docä¸­æåˆ°çš„semverï¼Œæ˜¯ä¸€ä¸ªè¯­ä¹‰åŒ–ç‰ˆæœ¬semantic versioningï¼Œå®ç°ç‰ˆæœ¬å’Œç‰ˆæœ¬è§„èŒƒçš„è§£æï¼Œè®¡ç®—ï¼Œæ¯”è¾ƒï¼Œç”¨ä»¥è§£å†³åœ¨å¤§å‹é¡¹ç›®ä¸­å¯¹ä¾èµ–çš„ç‰ˆæœ¬å¤±å»æ§åˆ¶çš„é—®é¢˜ï¼ŒNode.js çš„åŒ…ç®¡ç†å·¥å…· npm ä¹Ÿå®Œå…¨åŸºäº Semantic Versioning æ¥ç®¡ç†ä¾èµ–çš„ç‰ˆæœ¬ã€‚</p>
<p>å‚è€ƒèµ„æ–™ï¼š<a href="https://zhuanlan.zhihu.com/p/20747196" target="_blank" rel="noopener">semverï¼šè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒåœ¨ Node.js ä¸­çš„å®ç°</a></p>
<h2 id="deprecations"><a href="#deprecations" class="headerlink" title="deprecations"></a>deprecations</h2><p>sermverå¼ƒç”¨ä¸€éƒ¨åˆ†åŠŸèƒ½</p>
<ul>
<li><strong>(SEMVER-MAJOR)</strong> <strong>crypto</strong>: move pbkdf2 without digest to EOL (James M Snell) </li>
<li><strong>(SEMVER-MAJOR)</strong> <strong>fs</strong>: deprecate closing FileHandle on garbage collection (James M Snell)</li>
<li><strong>(SEMVER-MAJOR)</strong> <strong>http</strong>: move OutboundMessage.prototype.flush to EOL (James M Snell)</li>
<li><strong>(SEMVER-MAJOR)</strong> <strong>lib</strong>: move GLOBAL and root aliases to EOL (James M Snell)</li>
<li><strong>(SEMVER-MAJOR)</strong> <strong>os</strong>: move tmpDir() to EOL (James M Snell) </li>
<li><strong>(SEMVER-MAJOR)</strong> <strong>src</strong>: remove deprecated wasm type check (Clemens Backes) </li>
<li><strong>(SEMVER-MAJOR)</strong> <strong>stream</strong>: move _writableState.buffer to EOL (James M Snell)</li>
<li><strong>(SEMVER-MINOR)</strong> <strong>doc</strong>: deprecate process.mainModule (Antoine du HAMEL)</li>
<li><strong>(SEMVER-MINOR)</strong> <strong>doc</strong>: deprecate process.umask() with no arguments (Colin Ihrig) </li>
</ul>
<h2 id="ECMAScript-Modules"><a href="#ECMAScript-Modules" class="headerlink" title="ECMAScript Modules"></a>ECMAScript Modules</h2><p>åœ¨ <code>v13</code> ä¸­ï¼Œéœ€è¦è°ƒç”¨ <code>--experimental-modules</code> æ¥å¼€å¯ <code>ESM module</code> æ”¯æŒï¼Œ è€Œä¸”è¿˜ä¼šæœ‰è­¦å‘Šï¼Œä½†ç›®å‰å·²ç»ç§»é™¤è­¦å‘Šï¼ˆè¿˜æ˜¯éœ€è¦æ‰‹åŠ¨å¼€å¯ï¼‰<br>ä»åœ¨å®éªŒä¸­ï¼Œä½†æ˜¯å…¶å·²ç»éå¸¸å®Œå–„ï¼Œç§»é™¤è­¦å‘Šè¿ˆå‘äº†stableçš„é‡è¦ä¸€æ­¥</p>
<h2 id="New-V8-ArrayBuffer-API"><a href="#New-V8-ArrayBuffer-API" class="headerlink" title="New V8 ArrayBuffer API"></a>New V8 ArrayBuffer API</h2><p>v8ä¸å†æ”¯æŒå¤šä¸ªArrayBufferæŒ‡å‘ç›¸åŒçš„base address</p>
<h2 id="Toolchain-and-Compiler-Upgrades"><a href="#Toolchain-and-Compiler-Upgrades" class="headerlink" title="Toolchain and Compiler Upgrades"></a>Toolchain and Compiler Upgrades</h2><p>//æ²¡çœ‹æ‡‚</p>
<ul>
<li><strong>(SEMVER-MAJOR)</strong> <strong>build</strong>: update macos deployment target to 10.13 for 14.x (AshCripps) <a href="https://github.com/nodejs/node/pull/32454" target="_blank" rel="noopener">#32454</a></li>
<li><strong>(SEMVER-MAJOR)</strong> <strong>doc</strong>: update cross compiler machine for Linux armv7 (Richard Lau) <a href="https://github.com/nodejs/node/pull/32812" target="_blank" rel="noopener">#32812</a></li>
<li><strong>(SEMVER-MAJOR)</strong> <strong>doc</strong>: update Centos/RHEL releases use devtoolset-8 (Richard Lau) <a href="https://github.com/nodejs/node/pull/32812" target="_blank" rel="noopener">#32812</a></li>
<li><strong>(SEMVER-MAJOR)</strong> <strong>doc</strong>: remove SmartOS from official binaries (Richard Lau) <a href="https://github.com/nodejs/node/pull/32812" target="_blank" rel="noopener">#32812</a></li>
<li><strong>(SEMVER-MAJOR)</strong> <strong>win</strong>: block running on EOL Windows versions (JoÃ£o Reis) <a href="https://github.com/nodejs/node/pull/31954" target="_blank" rel="noopener">#31954</a></li>
</ul>
<p>It is expected that there will be an ABI mismatch on ARM between the Node.js binary and native addons. Native addons are only broken if they interact with <code>std::shared_ptr</code>. This is expected to be fixed in a later version of Node.js 14.</p>
<h2 id="Update-to-V8-8-1"><a href="#Update-to-V8-8-1" class="headerlink" title="Update to V8 8.1"></a>Update to V8 8.1</h2><h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><ul>
<li><strong>cli, report</strong>: move â€“report-on-fatalerror to stable (Colin Ihrig) </li>
<li><strong>deps</strong>: upgrade to libuv 1.37.0 (Colin Ihrig) </li>
<li><strong>fs</strong>: add fs/promises alias module </li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zehai.info/2020/04/21/2020-04-21-kubenates/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
      <meta itemprop="name" content="Zhang Zehai">
      <meta itemprop="description" content="ä¼šåšé¥­çš„å¨å­">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zehai'blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/21/2020-04-21-kubenates/" class="post-title-link" itemprop="url">kubernetes</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-21 16:18:55" itemprop="dateCreated datePublished" datetime="2020-04-21T16:18:55+08:00">2020-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 09:40:04" itemprop="dateModified" datetime="2020-05-30T09:40:04+08:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/kubernetes/" itemprop="url" rel="index"><span itemprop="name">kubernetes</span></a>
                </span>
            </span>

          
            <span id="/2020/04/21/2020-04-21-kubenates/" class="post-meta-item leancloud_visitors" data-flag-title="kubernetes" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/04/21/2020-04-21-kubenates/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/04/21/2020-04-21-kubenates/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="2-Basic"><a href="#2-Basic" class="headerlink" title="2.Basic"></a>2.Basic</h1><h2 id="2-1-åˆ›å»ºé›†ç¾¤"><a href="#2-1-åˆ›å»ºé›†ç¾¤" class="headerlink" title="2.1 åˆ›å»ºé›†ç¾¤"></a>2.1 åˆ›å»ºé›†ç¾¤</h2><p>minikube create</p>
<h2 id="2-2-éƒ¨ç½²åº”ç”¨"><a href="#2-2-éƒ¨ç½²åº”ç”¨" class="headerlink" title="2.2 éƒ¨ç½²åº”ç”¨"></a>2.2 éƒ¨ç½²åº”ç”¨</h2><p>ä¸€æ—¦è¿è¡Œäº† Kubernetes é›†ç¾¤ï¼Œå°±å¯ä»¥åœ¨å…¶ä¸Šéƒ¨ç½²å®¹å™¨åŒ–åº”ç”¨ç¨‹åºã€‚ ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦åˆ›å»º Kubernetes <strong>Deployment</strong> é…ç½®ã€‚Deployment <strong>æŒ‡æŒ¥ Kubernetes å¦‚ä½•åˆ›å»ºå’Œæ›´æ–°åº”ç”¨ç¨‹åºçš„å®ä¾‹</strong>ã€‚åˆ›å»º Deployment åï¼ŒKubernetes master å°†åº”ç”¨ç¨‹åºå®ä¾‹è°ƒåº¦åˆ°é›†ç¾¤ä¸­çš„å„ä¸ªèŠ‚ç‚¹ä¸Šã€‚</p>
<p>åˆ›å»ºåº”ç”¨ç¨‹åºå®ä¾‹åï¼ŒKubernetes Deployment æ§åˆ¶å™¨ä¼šæŒç»­ç›‘è§†è¿™äº›å®ä¾‹ã€‚ å¦‚æœæ‰˜ç®¡å®ä¾‹çš„èŠ‚ç‚¹å…³é—­æˆ–è¢«åˆ é™¤ï¼Œåˆ™ Deployment æ§åˆ¶å™¨ä¼šå°†è¯¥å®ä¾‹æ›¿æ¢ä¸ºç¾¤é›†ä¸­å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„å®ä¾‹ã€‚ <strong>è¿™æä¾›äº†ä¸€ç§è‡ªæˆ‘ä¿®å¤æœºåˆ¶æ¥è§£å†³æœºå™¨æ•…éšœç»´æŠ¤é—®é¢˜ã€‚</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create deployment kubernetes-bootcamp --image=gcr.io/google-samples/kubernetes-bootcamp:v1</span><br></pre></td></tr></table></figure>
<h2 id="2-3-äº†è§£åº”ç”¨"><a href="#2-3-äº†è§£åº”ç”¨" class="headerlink" title="2.3 äº†è§£åº”ç”¨"></a>2.3 äº†è§£åº”ç”¨</h2><p>Kubernates podsï¼ˆå·¥ä½œèŠ‚ç‚¹ï¼‰</p>
<p>åˆ›å»º Deployment æ—¶, Kubernetes æ·»åŠ äº†ä¸€ä¸ª <strong>Pod</strong> æ¥æ‰˜ç®¡ä½ çš„åº”ç”¨å®ä¾‹ã€‚Pod æ˜¯ Kubernetes æŠ½è±¡å‡ºæ¥çš„ï¼Œè¡¨ç¤ºä¸€ç»„ä¸€ä¸ªæˆ–å¤šä¸ªåº”ç”¨ç¨‹åºå®¹å™¨ï¼ˆå¦‚ Docker æˆ– rkt ï¼‰ï¼Œä»¥åŠè¿™äº›å®¹å™¨çš„ä¸€äº›å…±äº«èµ„æºã€‚è¿™äº›èµ„æºåŒ…æ‹¬:</p>
<ul>
<li>å…±äº«å­˜å‚¨ï¼Œå½“ä½œå·</li>
<li>ç½‘ç»œï¼Œä½œä¸ºå”¯ä¸€çš„é›†ç¾¤ IP åœ°å€</li>
<li>æœ‰å…³æ¯ä¸ªå®¹å™¨å¦‚ä½•è¿è¡Œçš„ä¿¡æ¯ï¼Œä¾‹å¦‚å®¹å™¨æ˜ åƒç‰ˆæœ¬æˆ–è¦ä½¿ç”¨çš„ç‰¹å®šç«¯å£ã€‚</li>
</ul>
<p>Pod ä¸ºç‰¹å®šäºåº”ç”¨ç¨‹åºçš„â€œé€»è¾‘ä¸»æœºâ€å»ºæ¨¡ï¼Œå¹¶ä¸”å¯ä»¥åŒ…å«ç›¸å¯¹ç´§è€¦åˆçš„ä¸åŒåº”ç”¨å®¹å™¨ã€‚ä¾‹å¦‚ï¼ŒPod å¯èƒ½æ—¢åŒ…å«å¸¦æœ‰ Node.js åº”ç”¨çš„å®¹å™¨ï¼Œä¹ŸåŒ…å«å¦ä¸€ä¸ªä¸åŒçš„å®¹å™¨ï¼Œç”¨äºæä¾› Node.js ç½‘ç»œæœåŠ¡å™¨è¦å‘å¸ƒçš„æ•°æ®ã€‚Pod ä¸­çš„å®¹å™¨å…±äº« IP åœ°å€å’Œç«¯å£ï¼Œå§‹ç»ˆä½äºåŒä¸€ä½ç½®å¹¶ä¸”å…±åŒè°ƒåº¦ï¼Œå¹¶åœ¨åŒä¸€å·¥ä½œèŠ‚ç‚¹ä¸Šçš„å…±äº«ä¸Šä¸‹æ–‡ä¸­è¿è¡Œã€‚</p>
<h2 id="2-4-æš´éœ²åº”ç”¨"><a href="#2-4-æš´éœ²åº”ç”¨" class="headerlink" title="2.4 æš´éœ²åº”ç”¨"></a>2.4 æš´éœ²åº”ç”¨</h2><h2 id="2-5-ä¼¸ç¼©åº”ç”¨"><a href="#2-5-ä¼¸ç¼©åº”ç”¨" class="headerlink" title="2.5 ä¼¸ç¼©åº”ç”¨"></a>2.5 ä¼¸ç¼©åº”ç”¨</h2><h2 id="2-6-æ›´æ–°åº”ç”¨"><a href="#2-6-æ›´æ–°åº”ç”¨" class="headerlink" title="2.6 æ›´æ–°åº”ç”¨"></a>2.6 æ›´æ–°åº”ç”¨</h2><h1 id="3-åœ¨çº¿åŸ¹è®­è¯¾ç¨‹"><a href="#3-åœ¨çº¿åŸ¹è®­è¯¾ç¨‹" class="headerlink" title="3.åœ¨çº¿åŸ¹è®­è¯¾ç¨‹"></a>3.åœ¨çº¿åŸ¹è®­è¯¾ç¨‹</h1><h1 id="4-é…ç½®"><a href="#4-é…ç½®" class="headerlink" title="4. é…ç½®"></a>4. é…ç½®</h1><h1 id="5-æ— çŠ¶æ€åº”ç”¨"><a href="#5-æ— çŠ¶æ€åº”ç”¨" class="headerlink" title="5.æ— çŠ¶æ€åº”ç”¨"></a>5.æ— çŠ¶æ€åº”ç”¨</h1><h1 id="6-æœ‰çŠ¶æ€åº”ç”¨"><a href="#6-æœ‰çŠ¶æ€åº”ç”¨" class="headerlink" title="6.æœ‰çŠ¶æ€åº”ç”¨"></a>6.æœ‰çŠ¶æ€åº”ç”¨</h1><h1 id="7-é›†ç¾¤"><a href="#7-é›†ç¾¤" class="headerlink" title="7.é›†ç¾¤"></a>7.é›†ç¾¤</h1><h1 id="8-Service"><a href="#8-Service" class="headerlink" title="8.Service"></a>8.Service</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zehai.info/2020/04/19/2020-04-19-LeetCodeWeek1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
      <meta itemprop="name" content="Zhang Zehai">
      <meta itemprop="description" content="ä¼šåšé¥­çš„å¨å­">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zehai'blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/19/2020-04-19-LeetCodeWeek1/" class="post-title-link" itemprop="url">LeetCodeWeek2</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-19 13:23:52" itemprop="dateCreated datePublished" datetime="2020-04-19T13:23:52+08:00">2020-04-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 09:33:31" itemprop="dateModified" datetime="2020-05-30T09:33:31+08:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/LeetCode/" itemprop="url" rel="index"><span itemprop="name">LeetCode</span></a>
                </span>
            </span>

          
            <span id="/2020/04/19/2020-04-19-LeetCodeWeek1/" class="post-meta-item leancloud_visitors" data-flag-title="LeetCodeWeek2" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/04/19/2020-04-19-LeetCodeWeek1/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/04/19/2020-04-19-LeetCodeWeek1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Problem-Product-of-Array-Except-Self"><a href="#Problem-Product-of-Array-Except-Self" class="headerlink" title="Problem Product of Array Except Self"></a>Problem Product of Array Except Self</h1><p>Given an array <code>nums</code> of <em>n</em> integers where <em>n</em> &gt; 1,  return an array <code>output</code> such that <code>output[i]</code> is equal to the product of all the elements of <code>nums</code> except <code>nums[i]</code>.</p>
<p><strong>Example:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input:  [1,2,3,4]</span><br><span class="line">Output: [24,12,8,6]</span><br></pre></td></tr></table></figure>
<p><strong>Constraint:</strong> Itâ€™s guaranteed that the product of the elements of any prefix or suffix of the array (including the whole array) fits in a 32 bit integer.</p>
<p><strong>Note:</strong> Please solve it <strong>without division</strong> and in O(<em>n</em>).</p>
<p><strong>Follow up:</strong><br>Could you solve it with constant space complexity? (The output array <strong>does not</strong> count as extra space for the purpose of space complexity analysis.)</p>
<h2 id="key"><a href="#key" class="headerlink" title="key"></a>key</h2><h2 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">//3ms</span><br><span class="line">class Solution &#123;</span><br><span class="line">    public int[] productExceptSelf(int[] nums) &#123;</span><br><span class="line">        int sum =1;</span><br><span class="line">        int hasZero =0;</span><br><span class="line">        for(int num :nums)&#123;</span><br><span class="line">            if(num!=0)&#123;</span><br><span class="line">                sum*=num;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                hasZero++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for(int i=0;i&lt;nums.length;i++)&#123;</span><br><span class="line">            if(hasZero&gt;=2)&#123;</span><br><span class="line">                nums[i]=0;</span><br><span class="line">            &#125;else if(hasZero==1)&#123;</span><br><span class="line">                if(nums[i]==0)&#123;</span><br><span class="line">                    nums[i]=sum;</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    nums[i]=0;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                nums[i]=sum/nums[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//1ms</span><br><span class="line">class Solution &#123;</span><br><span class="line">    public int[] productExceptSelf(int[] nums) &#123;</span><br><span class="line">        int n = nums.length;</span><br><span class="line">        int[] left = new int[n];</span><br><span class="line">        left[0] = 1;</span><br><span class="line">        for (int i = 1; i &lt; n; i++) &#123;</span><br><span class="line">            left[i] = left[i-1] * nums[i-1];</span><br><span class="line">        &#125;</span><br><span class="line">        int product = 1;</span><br><span class="line">        for (int i = n - 1; i &gt;= 0; i--) &#123;</span><br><span class="line">            left[i] *= product;</span><br><span class="line">            product *= nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        return left;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Problem-678Valid-Parenthesis-String"><a href="#Problem-678Valid-Parenthesis-String" class="headerlink" title="Problem-678Valid Parenthesis String"></a>Problem-678Valid Parenthesis String</h1><p><strong>Medium</strong></p>
<p>Given a string containing only three types of characters: â€˜(â€˜, â€˜)â€™ and â€˜*â€™, write a function to check whether this string is valid. We define the validity of a string by these rules:</p>
<ol>
<li>Any left parenthesis <code>&#39;(&#39;</code> must have a corresponding right parenthesis <code>&#39;)&#39;</code>.</li>
<li>Any right parenthesis <code>&#39;)&#39;</code> must have a corresponding left parenthesis <code>&#39;(&#39;</code>.</li>
<li>Left parenthesis <code>&#39;(&#39;</code> must go before the corresponding right parenthesis <code>&#39;)&#39;</code>.</li>
<li><code>&#39;*&#39;</code> could be treated as a single right parenthesis <code>&#39;)&#39;</code> or a single left parenthesis <code>&#39;(&#39;</code> or an empty string.</li>
<li>An empty string is also valid.</li>
</ol>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;()&quot;</span><br><span class="line">Output: True</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;(*)&quot;</span><br><span class="line">Output: True</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;(*))&quot;</span><br><span class="line">Output: True</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li>The string size will be in the range [1, 100].</li>
</ol>
<h2 id="key-1"><a href="#key-1" class="headerlink" title="key"></a>key</h2><h2 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkValidString</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s.length() == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>;<span class="keyword">int</span> star=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span>[] c = s.toCharArray();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> i : c) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (i) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'('</span>:</span><br><span class="line">                    left++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">')'</span>:</span><br><span class="line">                    left--;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'*'</span>:</span><br><span class="line">                    star++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (left == <span class="number">0</span> || left - star == <span class="number">0</span> || left + star == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Brute-Force"><a href="#Brute-Force" class="headerlink" title="Brute Force"></a>Brute Force</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> ans = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkValidString</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        solve(<span class="keyword">new</span> StringBuilder(s), <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">solve</span><span class="params">(StringBuilder sb, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i == sb.length()) &#123;</span><br><span class="line">            ans |= valid(sb);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sb.charAt(i) == <span class="string">'*'</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">char</span> c: <span class="string">"() "</span>.toCharArray()) &#123;</span><br><span class="line">                sb.setCharAt(i, c);</span><br><span class="line">                solve(sb, i+<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (ans) <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            sb.setCharAt(i, <span class="string">'*'</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span></span><br><span class="line">            solve(sb, i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">valid</span><span class="params">(StringBuilder sb)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> bal = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sb.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">char</span> c = sb.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="string">'('</span>) bal++;</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="string">')'</span>) bal--;</span><br><span class="line">            <span class="keyword">if</span> (bal &lt; <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bal == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Dynamic-Programming"><a href="#Dynamic-Programming" class="headerlink" title="Dynamic Programming"></a>Dynamic Programming</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkValidString</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.length();</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">boolean</span>[][] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[n][n];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s.charAt(i) == <span class="string">'*'</span>) dp[i][i] = <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; n-<span class="number">1</span> &amp;&amp;</span><br><span class="line">                    (s.charAt(i) == <span class="string">'('</span> || s.charAt(i) == <span class="string">'*'</span>) &amp;&amp;</span><br><span class="line">                    (s.charAt(i+<span class="number">1</span>) == <span class="string">')'</span> || s.charAt(i+<span class="number">1</span>) == <span class="string">'*'</span>)) &#123;</span><br><span class="line">                dp[i][i+<span class="number">1</span>] = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> size = <span class="number">2</span>; size &lt; n; size++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i + size &lt; n; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (s.charAt(i) == <span class="string">'*'</span> &amp;&amp; dp[i+<span class="number">1</span>][i+size] == <span class="keyword">true</span>) &#123;</span><br><span class="line">                    dp[i][i+size] = <span class="keyword">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s.charAt(i) == <span class="string">'('</span> || s.charAt(i) == <span class="string">'*'</span>) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k = i+<span class="number">1</span>; k &lt;= i+size; k++) &#123;</span><br><span class="line">                        <span class="keyword">if</span> ((s.charAt(k) == <span class="string">')'</span> || s.charAt(k) == <span class="string">'*'</span>) &amp;&amp;</span><br><span class="line">                                (k == i+<span class="number">1</span> || dp[i+<span class="number">1</span>][k-<span class="number">1</span>]) &amp;&amp;</span><br><span class="line">                                (k == i+size || dp[k+<span class="number">1</span>][i+size])) &#123;</span><br><span class="line">                            dp[i][i+size] = <span class="keyword">true</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][n-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Greedy"><a href="#Greedy" class="headerlink" title="Greedy"></a>Greedy</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkValidString</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">int</span> lo = <span class="number">0</span>, hi = <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">char</span> c: s.toCharArray()) &#123;</span><br><span class="line">           lo += c == <span class="string">'('</span> ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">           hi += c != <span class="string">')'</span> ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">           <span class="keyword">if</span> (hi &lt; <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">           lo = Math.max(lo, <span class="number">0</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> lo == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zehai.info/2020/04/16/2020-04-16-åŒä¸€å®¿ä¸»æœºä¸‹dockeräº’ç›¸è®¿é—®/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
      <meta itemprop="name" content="Zhang Zehai">
      <meta itemprop="description" content="ä¼šåšé¥­çš„å¨å­">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zehai'blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/16/2020-04-16-åŒä¸€å®¿ä¸»æœºä¸‹dockeräº’ç›¸è®¿é—®/" class="post-title-link" itemprop="url">åŒä¸€å®¿ä¸»æœºä¸‹dockeräº’ç›¸è®¿é—®</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-16 18:06:19" itemprop="dateCreated datePublished" datetime="2020-04-16T18:06:19+08:00">2020-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-30 09:33:31" itemprop="dateModified" datetime="2020-05-30T09:33:31+08:00">2020-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Question/" itemprop="url" rel="index"><span itemprop="name">Question</span></a>
                </span>
            </span>

          
            <span id="/2020/04/16/2020-04-16-åŒä¸€å®¿ä¸»æœºä¸‹dockeräº’ç›¸è®¿é—®/" class="post-meta-item leancloud_visitors" data-flag-title="åŒä¸€å®¿ä¸»æœºä¸‹dockeräº’ç›¸è®¿é—®" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/04/16/2020-04-16-åŒä¸€å®¿ä¸»æœºä¸‹dockeräº’ç›¸è®¿é—®/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/04/16/2020-04-16-åŒä¸€å®¿ä¸»æœºä¸‹dockeräº’ç›¸è®¿é—®/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>è¯¥æ–‡æ¡£è§£å†³ï¼šdockerä¸‹ï¼Œaltermanageræ”¶ä¸åˆ°prometheusæ¶ˆæ¯</p>
<p>äº‹å› ï¼Œæˆ‘åœ¨ä¸€ä¸ªå®¿ä¸»æœºä¸‹å»ºç«‹äº†å¤šä¸ªdockerå®¹å™¨</p>
<ul>
<li>node-exporter</li>
<li>prometheus</li>
<li>grafana</li>
<li>alertmanager</li>
<li>timonwong/prometheus-webhook-dingtalk</li>
</ul>
<p>è¿™äº›æœåŠ¡ä¹‹é—´ä¼šæœ‰ä¸€äº›äº’ç›¸è®¿é—®ï¼Œå¦‚prometheuså¯ä»¥å‘é€æ•°æ®ç»™alertmanageræ¥å‘é€æŠ¥è­¦ä¿¡æ¯ï¼Œalertmanageré€šè¿‡è§„åˆ™å¤„ç†å¯ä»¥å‘é€é‚®ä»¶ï¼Œå‘é€é’‰é’‰ç­‰æ–¹å¼å‘ŠçŸ¥ç”¨æˆ·ï¼Œé—®é¢˜å°±å‡ºåœ¨prometheusçš„ymlé…ç½®æ–‡æ¡£ä¸­ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">alerting:</span><br><span class="line">  alertmanagers:</span><br><span class="line">    - static_configs:</span><br><span class="line">        - targets: ['localhost:9002']  </span><br><span class="line">        </span><br><span class="line"><span class="meta">#</span>##############</span><br><span class="line">ä¿®æ”¹åï¼š</span><br><span class="line">alerting:</span><br><span class="line">  alertmanagers:</span><br><span class="line">    - static_configs:</span><br><span class="line">        - targets: ['10.10.10.10:9002']</span><br></pre></td></tr></table></figure>
<p>é—®é¢˜å‡ºåœ¨äº†prometheusçš„é…ç½®ä¸­è®¿é—®äº†localhostç«¯å£ï¼Œä½†è¿™ä¸ªå¹¶ä¸æ˜¯è®¿é—®å®¿ä¸»æœºçš„9002çš„ç«¯å£ï¼Œè€Œæ˜¯è®¿é—®çš„æ˜¯<code>dockerå†…éƒ¨çš„9002</code>ç«¯å£</p>
<p>æ‰¾åˆ°é—®é¢˜åï¼Œä½¿ç”¨äº†å®¿ä¸»æœºip+portçš„æ–¹å¼è¿›è¡Œè®¿é—®</p>
<h1 id="how"><a href="#how" class="headerlink" title="how"></a>how</h1><p>æŸ¥è¯¢äº†èµ„æ–™åï¼Œå‘ç°è§£å†³è¯¥é—®é¢˜çš„æ–¹æ³•æœ‰ï¼š</p>
<ul>
<li>å®¿ä¸»ipï¼športè®¿é—®</li>
<li>å®¹å™¨ipè®¿é—®</li>
<li>linkå»ºç«‹é€šä¿¡ç½‘ç»œ(å•å‘ï¼Œä¸æ¨è)â€“link xxx</li>
<li>user-defined networksï¼ˆdocker dns server/bridgeï¼‰</li>
</ul>
<p>å‰ä¸¤ç§ä¸å¤ªæ¨èï¼Œå› ä¸ºå¦‚æœå®¹å™¨ipæ›´æ”¹æˆ–è€…å®¿ä¸»æœºipæ›´æ”¹å°±éœ€è¦æ›´æ–°é…ç½®æ–‡æ¡£ï¼Œç¬¬ä¸‰ç§æ–¹æ³•ä¸å¤ªæ¨èï¼Œrun æ—¶å€™linkåªæ˜¯å•å‘çš„å»ºç«‹è¿æ¥ï¼Œç¬¬å››ç§<a href="https://docs.docker.com/engine/reference/commandline/network_create/" target="_blank" rel="noopener">docker network create</a>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//åˆ›å»ºç½‘ç»œ</span><br><span class="line">docker network create -d bridge my-bridge-network</span><br><span class="line">//runæ—¶å€™åŠ å…¥ç½‘ç»œ</span><br><span class="line">docker run -it --network test-network --network-alias mysql  -e MYSQL_ROOT_PASSWORD=123 mysql:5.7</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Zhang Zehai" src="https://avatars3.githubusercontent.com/u/23207152?s=460&v=4">
  <p class="site-author-name" itemprop="name">Zhang Zehai</p>
  <div class="site-description" itemprop="description">ä¼šåšé¥­çš„å¨å­</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">94</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ShawnGoethe" title="GitHub â†’ https://github.com/ShawnGoethe" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/zehaizhang@aliyun.com" title="E-Mail â†’ zehaizhang@aliyun.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://barriery.cn/" title="https://barriery.cn/" rel="noopener" target="_blank">barriery</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://learngitbranching.js.org/" title="https://learngitbranching.js.org/" rel="noopener" target="_blank">git-newer</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://regexone.com/" title="https://regexone.com/" rel="noopener" target="_blank">regex-newer</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://sqlzoo.net/" title="https://sqlzoo.net/" rel="noopener" target="_blank">sql-newer</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=298 height=52 src="//music.163.com/outchain/player?type=2&id=1385126398&auto=0&height=32"></iframe>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhang Zehai</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme â€“ <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.2
  </div>

        






  <script>
  function leancloudSelector(url) {
    url = encodeURI(url);
    return document.getElementById(url).querySelector('.leancloud-visitors-count');
  }
  if (CONFIG.page.isPost) {
    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.getAttribute('id'));
      var title = visitors.dataset.flagTitle;

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .then(response => response.json())
              .then(() => {
                leancloudSelector(url).innerText = counter.time + 1;
              })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              })
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  } else {
    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.getAttribute('id'));
      });

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url: { '$in': entries } })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length === 0) {
            document.querySelectorAll('.leancloud_visitors .leancloud-visitors-count').forEach(element => {
              element.innerText = 0;
            });
            return;
          }
          for (let item of results) {
            let { url, time } = item;
            leancloudSelector(url).innerText = time;
          }
          for (let url of entries) {
            var element = leancloudSelector(url);
            if (element.innerText == '') {
              element.innerText = 0;
            }
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  }

  fetch('https://app-router.leancloud.cn/2/route?appId=pc6nnLuEjNG6bbE4yA4diNOH-gzGzoHsz')
    .then(response => response.json())
    .then(({ api_server }) => {
      var Counter = (method, url, data) => {
        return fetch(`https://${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : 'pc6nnLuEjNG6bbE4yA4diNOH-gzGzoHsz',
            'X-LC-Key'    : '7wLVv3rk9lEybmPjgAWD4jwl',
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    });
  </script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'pc6nnLuEjNG6bbE4yA4diNOH-gzGzoHsz',
      appKey     : '7wLVv3rk9lEybmPjgAWD4jwl',
      placeholder: "please leave your suggestion",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
